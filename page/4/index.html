<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.2.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"sillywa.com","root":"/","scheme":"Pisces","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta name="description" content="个人学习记录博客">
<meta property="og:type" content="website">
<meta property="og:title" content="Sillywa&#39;s Blog">
<meta property="og:url" content="https://sillywa.com/page/4/index.html">
<meta property="og:site_name" content="Sillywa&#39;s Blog">
<meta property="og:description" content="个人学习记录博客">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="Sillywa">
<meta property="article:tag" content="博客">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="https://sillywa.com/page/4/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'zh-CN'
  };
</script>

  <title>Sillywa's Blog</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">Sillywa's Blog</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content index posts-expand">
            
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://sillywa.com/2018/12/06/%E5%86%92%E6%B3%A1%E6%8E%92%E5%BA%8F/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/logo.png">
      <meta itemprop="name" content="Sillywa">
      <meta itemprop="description" content="个人学习记录博客">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Sillywa's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2018/12/06/%E5%86%92%E6%B3%A1%E6%8E%92%E5%BA%8F/" class="post-title-link" itemprop="url">冒泡排序</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2018-12-06 21:21:36" itemprop="dateCreated datePublished" datetime="2018-12-06T21:21:36+08:00">2018-12-06</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2020-09-23 16:49:34" itemprop="dateModified" datetime="2020-09-23T16:49:34+08:00">2020-09-23</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E7%AE%97%E6%B3%95/" itemprop="url" rel="index"><span itemprop="name">算法</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>冒泡排序是最简单的交换排序，冒泡排序基本原理：</p>
<blockquote>
<p>对 N 个元素的待排序序列，共进行 N-1 次循环。<br>在第 k 次循环中，从第1到第 N-k 个元素从前往后进行比较，每次比较相邻的两个元素，若前一个元素比后一个大则交换两元素的位置，否则位置保持不变。<br>这样一次循环，就把第 k 大的元素放在了 N-k 的位置上，称为第 k 趟冒泡。整个过程共进行 N-1 趟，直到第 1 个元素和第 2 个元素比较完成，最终剩余最小的元素留在第一个位置，排序结束。</p>
</blockquote>
<!--- more --->

<p>C 语言实现：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 这里我们可以增加一个flag,如果一趟排序下来没有任何元素交换，说明序列是有序的，不需要继续进行下一次循环</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Swap</span><span class="params">(<span class="keyword">int</span> *a, <span class="keyword">int</span>* b)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> temp = *a;</span><br><span class="line">    *a = *b;</span><br><span class="line">    *b = temp;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">BubbleSort</span><span class="params">(<span class="keyword">int</span> a[],<span class="keyword">int</span> N)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> i,j;</span><br><span class="line">    <span class="keyword">int</span> flag;</span><br><span class="line">    <span class="keyword">for</span>(i = N-<span class="number">1</span>;i &gt;= <span class="number">0</span>;i--)&#123;</span><br><span class="line">        flag = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(j = <span class="number">0</span>;j &lt; i;j++)&#123;</span><br><span class="line">            <span class="keyword">if</span>(a[j] &gt; a[j+<span class="number">1</span>])&#123;</span><br><span class="line">                Swap(&amp;a[j],&amp;a[j+<span class="number">1</span>]);</span><br><span class="line">                flag = <span class="number">1</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 全程无元素交换，退出循环</span></span><br><span class="line">        <span class="keyword">if</span> (!flag) &#123;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>JS语言实现：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">BubbleSort</span>(<span class="params">a</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">let</span> i,j;</span><br><span class="line">    <span class="keyword">let</span> flag;</span><br><span class="line">    <span class="keyword">let</span> N = a.length;</span><br><span class="line">    <span class="keyword">for</span>(i = N<span class="number">-1</span>;i &gt;= <span class="number">0</span>;i--)&#123;</span><br><span class="line">        flag = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(j = <span class="number">0</span>;j &lt; i;j++)&#123;</span><br><span class="line">            <span class="keyword">if</span>(a[j] &gt; a[j+<span class="number">1</span>])&#123;</span><br><span class="line">                [a[j],a[j+<span class="number">1</span>]] = [a[j+<span class="number">1</span>],a[j]];</span><br><span class="line">                flag = <span class="number">1</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 全程无元素交换，退出循环</span></span><br><span class="line">        <span class="keyword">if</span> (!flag) &#123;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>很显然最坏情况下，冒泡排序的时间复杂度为 <code>O(N²)</code> ；在最好情况下，由于用了 <code>flag</code> 标记，只需要进行 <code>O(N)</code> 次比较就从循环中跳出来了。程序的平均时间复杂度为 <code>O(N²)</code>。</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://sillywa.com/2018/12/06/%E5%90%8C%E6%BA%90%E7%AD%96%E7%95%A5/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/logo.png">
      <meta itemprop="name" content="Sillywa">
      <meta itemprop="description" content="个人学习记录博客">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Sillywa's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2018/12/06/%E5%90%8C%E6%BA%90%E7%AD%96%E7%95%A5/" class="post-title-link" itemprop="url">同源策略及其解决方案</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2018-12-06 13:32:16" itemprop="dateCreated datePublished" datetime="2018-12-06T13:32:16+08:00">2018-12-06</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2020-09-23 16:50:57" itemprop="dateModified" datetime="2020-09-23T16:50:57+08:00">2020-09-23</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E5%89%8D%E7%AB%AF%E5%9F%BA%E7%A1%80/" itemprop="url" rel="index"><span itemprop="name">前端基础</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>“同源政策”是浏览器安全的基石，其设计目的是为了保证信息安全，防止恶意的网站窃取数据。所谓“同源”必须满足以下三个方面：</p>
<ol>
<li>协议相同</li>
<li>域名相同</li>
<li>端口相同（默认端口是80，可以省略）</li>
</ol>
<!--- more --->

<p>如果是非同源的，以下行为会受到限制：</p>
<ul>
<li><code>Cookie、LocalStorage</code>和<code>IndexDB</code>无法读取</li>
<li><code>DOM</code>无法获取</li>
<li><code>AJAX</code>请求不能发送</li>
</ul>
<p>接下来我们主要讲解如何解决以上三个方面的问题。</p>
<h3 id="一、Cookie"><a href="#一、Cookie" class="headerlink" title="一、Cookie"></a>一、Cookie</h3><p><code>Cookie</code>只有同源的网站才能获取，但是如果两个网页的一级域名相同，只是二级域名不同，可以设置相同的<code>document.domain</code>，两个网页就可以共享<code>cookie</code>了。</p>
<blockquote>
<p>很多人都误把带<code>www</code>当成一级域名，把其他前缀的当成二级域名，是错误的。正确的域名划分为：</p>
<ol>
<li>顶级域名：<code>.com</code></li>
<li>一级域名：<code>baidu.com</code></li>
<li>二级域名：<code>tieba.baidu.com</code></li>
</ol>
<p>举例来说，A网页是<code>http://w1.sillywa.com/a.html</code>，B网页是<code>http://w2.sillywa.com/b.html</code>，我们可以设置</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">document</span>.domain = <span class="string">&#x27;sillywa.com&#x27;</span></span><br></pre></td></tr></table></figure>
<p>这样两个网页就可以共享<code>Cookie</code>了。</p>
<p>注意，这种方法只是用于<code>Cookie</code>和<code>iframe</code>，<code>LocalStorage</code>和<code>IndexDB</code>无法通过这种方法规避同源政策，而是要是用<code>PostMessage API</code>，下面我们会介绍。</p>
<h3 id="二、iframe"><a href="#二、iframe" class="headerlink" title="二、iframe"></a>二、iframe</h3><p>如果两个网页不同源，就没法拿到对方的<code>DOM</code>。典型的例子是<code>iframe</code>窗口和用<code>window.open</code>方法打开的窗口，它们与父窗口无法通信。</p>
<p>所以对于完全不同源的网站，目前可以使用一下三种办法规避同源问题：</p>
<ul>
<li>片段标识符(<code>fragment identifier</code>)</li>
<li><code>window.name</code></li>
<li>跨文档通信<code>API</code>(<code>window.postMessage</code>)</li>
</ul>
<h4 id="1-片段标识符"><a href="#1-片段标识符" class="headerlink" title="1.片段标识符"></a>1.片段标识符</h4><p>片段标识符指的是<code>URL</code>中<code>#</code>后面的内容，比如<code>http://sillywa.com/a.html#fragment</code>中的<code>#fragment</code>，如果只是改变片段标识符，页面不会重新刷新。</p>
<p>父窗口可以把信息写入子窗口的片段标识符：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> src = originURL + <span class="string">&#x27;#&#x27;</span> + data</span><br><span class="line"><span class="built_in">document</span>.getElementById(<span class="string">&#x27;myIframe&#x27;</span>).src = src</span><br></pre></td></tr></table></figure>
<p>子窗口通过监听<code>hashchange</code>事件得到通知：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">window</span>.onhashchange = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="built_in">window</span>.location.hash)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="2-window-name"><a href="#2-window-name" class="headerlink" title="2.window.name"></a>2.window.name</h4><p>浏览器窗口有<code>window.name</code>属性。这个属性的最大特点是，无论是否同源，只要在同一个窗口里，前一个网页设置了这个属性，后一个网页可以读取它。</p>
<h4 id="3-window-postMessage"><a href="#3-window-postMessage" class="headerlink" title="3. window.postMessage"></a>3. window.postMessage</h4><p><code>HTML5</code>为了解决跨窗口通讯问题引入了一个新的<code>API</code>：跨文档通信<code>API</code>。这个<code>API</code>为<code>window</code>新增了一个<code>window.postMessage()</code>方法，允许跨窗口通讯，不论这两个窗口是否同源。举例来说：假设父窗口为：<code>http://aaa.com</code>，子窗口为：<code>http://bbb.com</code></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 父窗口向子窗口发送消息</span></span><br><span class="line"><span class="keyword">var</span> popup = <span class="built_in">window</span>.open(<span class="string">&#x27;http://bbb.com&#x27;</span>, <span class="string">&#x27;title&#x27;</span>);</span><br><span class="line">popup.postMessage(<span class="string">&#x27;Hello World!&#x27;</span>, <span class="string">&#x27;http://bbb.com&#x27;</span>);</span><br></pre></td></tr></table></figure>
<p><code>postMessage()</code>方法的第一个参数是具体的信息内容，第二个参数是接收消息的窗口的源（<code>origin</code>），即”协议 + 域名 + 端口”。也可以设为*，表示不限制域名，向所有窗口发送。</p>
<p>同样，子窗口向父窗口发送消息可以这样写：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">window</span>.opener.postMessage(<span class="string">&#x27;Nice to see you&#x27;</span>, <span class="string">&#x27;http://aaa.com&#x27;</span>);</span><br></pre></td></tr></table></figure>
<p>父窗口和子窗口都可以通过<code>message</code>事件，监听对方的消息：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">window</span>.addEventListener(<span class="string">&#x27;message&#x27;</span>, <span class="function"><span class="keyword">function</span>(<span class="params">e</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(e.data)</span><br><span class="line">&#125;,<span class="literal">false</span>)</span><br></pre></td></tr></table></figure>
<p><code>message</code>事件的<code>event</code>对象有以下三个属性：</p>
<ol>
<li><code>event.source：</code>发送消息的窗口</li>
<li><code>event.origin：</code>消息发送的网址</li>
<li><code>event.data：</code>消息内容</li>
</ol>
<p>下面的例子是，子窗口通过<code>event.source</code>属性引用父窗口，然后发送消息。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">window</span>.addEventListener(<span class="string">&#x27;message&#x27;</span>, receiveMessage);</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">receiveMessage</span>(<span class="params">event</span>) </span>&#123;</span><br><span class="line">  event.source.postMessage(<span class="string">&#x27;Nice to see you!&#x27;</span>, <span class="string">&#x27;*&#x27;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>如果我们将发送的消息改为<code>LocalStorage</code>，则可以互相读取<code>LocalStorage</code>。</p>
<h3 id="三、AJAX"><a href="#三、AJAX" class="headerlink" title="三、AJAX"></a>三、AJAX</h3><p>同样<code>AJAX</code>请求也会受到同源策略的影响，除了使用代理服务器外，还有一下方法可以实现跨域：</p>
<ul>
<li><code>jsonp</code></li>
<li><code>WebScoket</code></li>
<li><code>CORS</code></li>
</ul>
<h4 id="1-jsonp"><a href="#1-jsonp" class="headerlink" title="1.jsonp"></a>1.jsonp</h4><p><code>jsonp</code>想必大家都很了解，其由两部分组成：回调函数和数据。其基本思路是：动态插入<code>script</code>标签，向服务器请求<code>json</code>数据，返回的数据将在回调函数里获得。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">addScriptTag</span>(<span class="params">src</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> script = <span class="built_in">document</span>.createElement(<span class="string">&#x27;script&#x27;</span>);</span><br><span class="line">  script.setAttribute(<span class="string">&quot;type&quot;</span>,<span class="string">&quot;text/javascript&quot;</span>);</span><br><span class="line">  script.src = src;</span><br><span class="line">  <span class="built_in">document</span>.body.appendChild(script);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 定义回调函数</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">foo</span>(<span class="params">data</span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">&#x27;Your public IP address is: &#x27;</span> + data.ip);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="built_in">window</span>.onload = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  addScriptTag(<span class="string">&#x27;http://example.com/ip?callback=foo&#x27;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>上面代码通过动态添加<code>&lt;script&gt;</code>元素，向服务器<code>example.com</code>发出请求。注意，该请求的查询字符串有一个<code>callback</code>参数，用来指定回调函数的名字，这对于<code>JSONP</code>是必需的。</p>
<h4 id="2-WebScoket"><a href="#2-WebScoket" class="headerlink" title="2.WebScoket"></a>2.WebScoket</h4><p><code>WebScoket</code>不同于<code>http</code>，它提供一种双向通讯的功能，即客户端可以向服务器请求数据，同时服务器也可以向客户端发送数据。而<code>http</code>只能是单向的。</p>
<p>同时<code>WebScoket</code>使用<code>ws:\//</code>（非加密）和<code>wss:\//</code>（加密）作为协议前缀。该协议不实行同源政策，只要服务器支持，就可以通过它进行跨源通信。</p>
<p>要创建<code>WebScoket</code>，先实例化一个<code>WebScoket</code>对象并传入要连接的<code>URL</code>：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> scoket = <span class="keyword">new</span> WebScoket(<span class="string">&quot;ws://www.example.com/server.php&quot;</span>)</span><br></pre></td></tr></table></figure>
<p>实例化<code>WebScoket</code>对象之后，浏览器会马上尝试建立连接。与<code>XHR</code>类似，<code>WebScoket</code>也有一系列表示当前状态的<code>readyState</code>属性，如下：</p>
<ul>
<li><code>WebScoket.OPENING</code>  (0)：正在建立连接</li>
<li><code>WebScoket.OPEN</code>  (1)：已经建立连接</li>
<li><code>WebScoket.CLOSING</code>  (2)：正在关闭连接</li>
<li><code>WebScoket.ClOSE</code>  (3)：已经关闭连接</li>
</ul>
<p><code>WebScoket</code>没有<code>readyStatechange</code>事件；不过它有其他的事件，我们待会介绍。</p>
<p>要关闭<code>WebScoket</code>连接，可以调用<code>close()</code>方法：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">scoket.close()</span><br></pre></td></tr></table></figure>

<p><code>WebScoket</code>连接之后，就可以发送和就收数据。要发送数据可以调用<code>send()</code>方法，并传入字符串，例如：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> scoket = <span class="keyword">new</span> WebScoket(<span class="string">&quot;ws://www.example.com/server.php&quot;</span>)</span><br><span class="line">scoket.send(<span class="string">&#x27;hello word&#x27;</span>)</span><br></pre></td></tr></table></figure>
<p>因为<code>WebScoket</code>只能发送纯文本数据，所以对于复杂的数据类型我们应先将其序列化转化为json字符串</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> message = &#123;</span><br><span class="line">    name: <span class="string">&#x27;sillywa&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line">scoket.send(<span class="built_in">JSON</span>.stringify(message))</span><br></pre></td></tr></table></figure>
<p>同样服务器必须先解析再读取数据。</p>
<p>当服务器向客户端发来消息时，<code>WebScoket</code>对象就会触发<code>message</code>事件。这个<code>message</code>事件与其它传递消息的协议类似，也就是把返回的数据保存在<code>event.data</code>的属性中。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">scoket.onmessage = <span class="function"><span class="keyword">function</span>(<span class="params">event</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(event.data)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>与通过<code>send()</code>发送到服务器的数据一样，<code>event.data</code>中返回的数据也是字符串。</p>
<p><code>WebScoket</code>对象还有其他三个事件，在连接生命周期的不同阶段触发。</p>
<ul>
<li><code>open：</code>在成功建立连接时触发</li>
<li><code>error</code>：在发生错误时触发，连接不能持续</li>
<li><code>close：</code>在连接关闭时触发<br><code>WebScoket</code>对象不支持<code>DOM2</code>级事件侦听器，因此必须使用<code>DOM0</code>级语法分别定义每个事件处理程序。<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> scoket = <span class="keyword">new</span> WebScoket(<span class="string">&quot;ws://www.example.com/server.php&quot;</span>)</span><br><span class="line">scoket.onopen = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&#x27;connection start&#x27;</span>)</span><br><span class="line">&#125;</span><br><span class="line">scoket.onerror = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&#x27;connection error&#x27;</span>)</span><br><span class="line">&#125;</span><br><span class="line">scoket.onclose = <span class="function"><span class="keyword">function</span>(<span class="params">event</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(event)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
在这三个事件中只有<code>close</code>的<code>event</code>对象有额外的信息。这个事件的对象有三个额外的属性：<code>wasClean、code、reason</code>。其中<code>wasClean</code>是一个布尔值，表示连接是否已经明确地关闭；<code>code</code>是服务器返回的数值状态码；<code>reason</code>是一个字符串，包含服务器发回的信息。<h4 id="3-CORS"><a href="#3-CORS" class="headerlink" title="3.CORS"></a>3.CORS</h4><code>CORS</code>是一个<code>W3C</code>标准，全称是”跨域资源共享”（<code>Cross-origin resource sharing</code>）。</li>
</ul>
<p>它允许浏览器向跨源服务器，发出<code>XMLHttpRequest</code>请求，从而克服了<code>AJAX</code>只能同源使用的限制。</p>
<p>相比<code>jsonp</code>只能发送<code>get</code>请求，<code>CORS</code>允许发送任何类型的请求。但<code>CORS</code>要求浏览器和服务器同时支持。目前所有浏览器都支持，<code>IE</code>需要<code>IE10</code>以上。</p>
<p>整个<code>CORS</code>通讯过程中都是浏览器自动完成，不需要用户的参与。<code>CORS</code>通讯和同源的<code>AJAX</code>请求没有区别。浏览器一旦发现<code>AJAX</code>请求跨域，就会自动添加一些头部信息，有时候还会多出一次附加请求。</p>
<p>浏览器将<code>CORS</code>请求分为两类：简单请求和非简单请求。</p>
<p>只要同时满足一下两个条件就是简单请求，否则就是非简单请求：</p>
<p>（1）请求方法是下列方法之一：</p>
<ul>
<li><code>HEAD</code></li>
<li><code>GET</code></li>
<li><code>POST</code></li>
</ul>
<p>（2）<code>http</code>的头信息不超出以下几个字段：</p>
<ul>
<li><code>Accept</code></li>
<li><code>Accept-Language</code></li>
<li><code>Content-Language</code></li>
<li><code>Last-Event-ID</code></li>
<li><code>Content-Type</code>：只限于三个值<code>application/x-www-form-urlencoded、multipart/form-data、text/plain</code></li>
</ul>
<p>对于简单请求，浏览器会自动在头部信息里增加一个<code>Origin</code>字段，用来表示请求来自与哪个源，服务器根据这个值决定是否同意此次请求。如果<code>Origin</code>不在请求范围内，服务器返回一个正常的<code>http</code>回应。这个回应的头信息中没有<code>Access-Control-Allow-Origin</code>字段，浏览器发现没有这个字段之后就会抛出一个错误。如果<code>Origin</code>在请求范围内，服务器返回的响应会多出几个头信息字段，其中一个是<code>Access-Control-Allow-Origin</code>，它的值要么是<code>Origin</code>的值，要么是*，表示允许任何域名的请求。</p>
<p>对于非简单请求，它会在正式通信之前，增加一次<code>http</code>查询请求，称为”预检”请求（<code>preflight</code>）。通常是一个<code>OPTION</code>请求。这个请求先询问服务器，当前网页所在的域名是否在服务器的许可名单之中，以及可以使用哪<code>http</code>动词和头信息字段。只有得到肯定答复，浏览器才会发出正式的<code>XMLHttpRequest</code>请求，否则就报错。</p>
<p>如果大家想要更详细的了解<code>CORS</code>，可以参考以下文章。</p>
<p>参考文章：</p>
<p>阮一峰《<a target="_blank" rel="noopener" href="http://www.ruanyifeng.com/blog/2016/04/same-origin-policy.html">浏览器同源政策及其规避方法</a>》</p>
<p>阮一峰《<a target="_blank" rel="noopener" href="http://www.ruanyifeng.com/blog/2016/04/cors.html">跨域资源共享 CORS 详解</a>》</p>
<p>参考书籍：</p>
<p>《javascript高级程序设计》</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://sillywa.com/2018/12/06/reflow-and-repaint/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/logo.png">
      <meta itemprop="name" content="Sillywa">
      <meta itemprop="description" content="个人学习记录博客">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Sillywa's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2018/12/06/reflow-and-repaint/" class="post-title-link" itemprop="url">浏览器回流(Reflow)与重绘(Repaint)及其思考</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2018-12-06 13:30:51" itemprop="dateCreated datePublished" datetime="2018-12-06T13:30:51+08:00">2018-12-06</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2020-09-23 16:55:21" itemprop="dateModified" datetime="2020-09-23T16:55:21+08:00">2020-09-23</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E5%89%8D%E7%AB%AF%E5%9F%BA%E7%A1%80/" itemprop="url" rel="index"><span itemprop="name">前端基础</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>我们知道浏览器在解析文档时，会经历以下步骤：</p>
<ol>
<li>将<code>HTML</code>解析为<code>DOM</code>，将<code>CSS</code>解析为<code>CSSOM</code>，<code>DOM</code>和<code>CSSOM</code>合并生成<code>Render Tree</code></li>
<li>然后根据<code>Render Tree</code>将节点绘制在页面上</li>
</ol>
<p>所谓回流是当元素尺寸、结构或者某些属性发生改变时，浏览器重新部分或者全部渲染文档的过程。<br>所谓重绘是指元素样式发生改变但并未改变其在文档流中的位置。</p>
<!--- more --->

<h3 id="回流-Reflow"><a href="#回流-Reflow" class="headerlink" title="回流(Reflow)"></a>回流(Reflow)</h3><p>我们理解了回流之后再看看哪些操作会导致浏览器回流：</p>
<ol>
<li>浏览器窗口大小发生改变</li>
<li>元素尺寸或者位置发生变化</li>
<li>元素内容变化</li>
<li>元素字体变化</li>
<li>添加或删除<code>DOM</code></li>
<li>激活<code>CSS</code>伪类</li>
<li>查询某些属性或调用某些方法：<ul>
<li><code>clientWidth、clientHeight、clientTop、clientLeft</code></li>
<li><code>offsetWidth、offsetHeight、offsetTop、offsetLeft</code></li>
<li><code>scrollWidth、scrollHeight、scrollTop、scrollLeft</code></li>
<li><code>scrollIntoView()、scrollIntoViewIfNeeded()</code></li>
<li><code>getComputedStyle()</code></li>
<li><code>getBoundingClientRect()</code></li>
<li><code>scrollTo()</code></li>
</ul>
</li>
</ol>
<h3 id="重绘-Repaint"><a href="#重绘-Repaint" class="headerlink" title="重绘(Repaint)"></a>重绘(Repaint)</h3><p>当页面中元素的样式改变并不影响其在文档流中得到位置时，浏览器紧紧将新样式赋给它并重新绘制，这就是重绘。例如<code>color、background-color、visibility</code></p>
<h3 id="思考"><a href="#思考" class="headerlink" title="思考"></a>思考</h3><p>既然这样那么我们如何避免重绘与回流呢？</p>
<ul>
<li>避免使用<code>table</code>布局</li>
<li>将动画效果应用到<code>position</code>属性为<code>absolute</code>或<code>fixed</code>的元素上，脱离文档流的元素不会引起回流</li>
<li>可以使用<code>tranform</code>属性来设置动画</li>
<li>避免频繁操作样式，最好使用<code>class</code>来更改样式</li>
<li>避免频繁操作<code>DOM</code>，创建一个<code>documentFragment</code>，在它上面进行<code>DOM</code>操作</li>
<li>可以先将元素设为<code>display:none</code>，操作后再把它显示出来。因为在<code>display</code>为<code>none</code>的元素上操作不会引起重绘与回流</li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://sillywa.com/2018/12/06/event/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/logo.png">
      <meta itemprop="name" content="Sillywa">
      <meta itemprop="description" content="个人学习记录博客">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Sillywa's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2018/12/06/event/" class="post-title-link" itemprop="url">JS事件</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2018-12-06 13:27:14" itemprop="dateCreated datePublished" datetime="2018-12-06T13:27:14+08:00">2018-12-06</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2020-09-23 16:53:28" itemprop="dateModified" datetime="2020-09-23T16:53:28+08:00">2020-09-23</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/JavaScript-%E5%9F%BA%E7%A1%80/" itemprop="url" rel="index"><span itemprop="name">JavaScript 基础</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>事件用来处理js与HTML之间的交互，我们可以使用事件处理程序来监听事件，以便在事件发生时执行相应代码。</p>
<!--- more --->

<h3 id="一、事件流"><a href="#一、事件流" class="headerlink" title="一、事件流"></a>一、事件流</h3><ul>
<li>事件冒泡：IE事件流叫做事件冒泡，即事件由最具体的元素向外传播，是由内向外的</li>
<li>事件捕获：事件捕获即事件由不具体的元素到具体元素，是由外向内传播</li>
<li>DOM事件流：DOM2级事件规定的事件流包括三个阶段：事件捕获阶段、处于目标阶段和事件冒泡阶段</li>
</ul>
<h3 id="二、事件处理程序"><a href="#二、事件处理程序" class="headerlink" title="二、事件处理程序"></a>二、事件处理程序</h3><ul>
<li><h4 id="HTML事件处理程序"><a href="#HTML事件处理程序" class="headerlink" title="HTML事件处理程序"></a>HTML事件处理程序</h4></li>
</ul>
<p>直接在html代码中绑定事件</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;div onclick=<span class="string">&quot;doSomething()&quot;</span>&gt;&lt;/div&gt;</span><br></pre></td></tr></table></figure>
<p>我们一般不采用这种方法绑定事件，因为html代码与js代码耦合度太高，不便于维护。但是现在的vue框架使用的却是这种事件处理程序。</p>
<ul>
<li><h4 id="DOM0级事件处理程序"><a href="#DOM0级事件处理程序" class="headerlink" title="DOM0级事件处理程序"></a>DOM0级事件处理程序</h4></li>
</ul>
<p>这种方法就是将一个函数赋值给一个事件处理程序属性。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> btn = <span class="built_in">document</span>.getElementById(<span class="string">&#x27;myBtn&#x27;</span>)</span><br><span class="line">btn.onclick = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="comment">// do something</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>其中我们需要注意的是DOM0级事件处理程序被认为是元素的方法，因此事件处理程序是在元素的作用域中运行的，this指向当前元素。</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> btn = <span class="built_in">document</span>.getElementById(<span class="string">&#x27;myBtn&#x27;</span>)</span><br><span class="line">btn.onclick = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="comment">// 输出元素的id属性</span></span><br><span class="line">    <span class="built_in">console</span>.log(<span class="built_in">this</span>.id)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li><h4 id="DOM2级事件处理程序"><a href="#DOM2级事件处理程序" class="headerlink" title="DOM2级事件处理程序"></a>DOM2级事件处理程序</h4></li>
</ul>
<p>DOM2级事件处理程序定义了两个方法，用于处理指定和删除事件处理程序的操作：<code>addEventListener()</code>和<code>removeEventListener()</code>。所有DOM节点都包含这两个方法，并且他们都接受三个参数：要处理的事件名、作为事件处理程序的函数和一个布尔值。最后一个布尔值如果为true表示在捕获阶段调用事件处理程序；如果为false表示在冒泡阶段调用事件处理程序。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> btn = <span class="built_in">document</span>.getElementById(<span class="string">&#x27;myBtn&#x27;</span>)</span><br><span class="line">btn.addEventListener(<span class="string">&#x27;click&#x27;</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="comment">// do something</span></span><br><span class="line">&#125;, <span class="literal">false</span>)</span><br></pre></td></tr></table></figure>
<p>使用DOM2级事件处理程序的好处是可以为一个节点添加多个事件处理程序。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> btn = <span class="built_in">document</span>.getElementById(<span class="string">&#x27;myBtn&#x27;</span>)</span><br><span class="line">btn.addEventListener(<span class="string">&#x27;click&#x27;</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="comment">// do something</span></span><br><span class="line">    alert(<span class="number">0</span>)</span><br><span class="line">&#125;, <span class="literal">false</span>)</span><br><span class="line">btn.addEventListener(<span class="string">&#x27;click&#x27;</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="comment">// do something</span></span><br><span class="line">    alert(<span class="number">1</span>)</span><br><span class="line">&#125;, <span class="literal">false</span>)</span><br></pre></td></tr></table></figure>
<p>这两个事件处理程序会按照顺序依次执行，所以首先弹出0，再弹出1。</p>
<p>通过<code>addEventListener()</code>添加的事件处理程序只能使用<code>removeEventListener()</code>来移除；移除时使用的参数应当与添加时相同。这也就是说直接添加的匿名函数处理程序是无法移除的，举例来说：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> btn = <span class="built_in">document</span>.getElementById(<span class="string">&#x27;myBtn&#x27;</span>)</span><br><span class="line">btn.addEventListener(<span class="string">&#x27;click&#x27;</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="comment">// do something</span></span><br><span class="line">    alert(<span class="number">0</span>)</span><br><span class="line">&#125;, <span class="literal">false</span>)</span><br><span class="line">btn.removeEventListener(<span class="string">&#x27;click&#x27;</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;  <span class="comment">// 没有用</span></span><br><span class="line">    <span class="comment">// do something</span></span><br><span class="line">    alert(<span class="number">0</span>)</span><br><span class="line">&#125;, <span class="literal">false</span>)</span><br></pre></td></tr></table></figure>
<p>在这个例子中我们虽然调用<code>removeEventListener()</code>使用的看似相同的参数，其实两个匿名函数根本不同，所以我们的给函数起个名字：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> btn = <span class="built_in">document</span>.getElementById(<span class="string">&#x27;myBtn&#x27;</span>)</span><br><span class="line"><span class="keyword">var</span> handler = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="comment">// do something</span></span><br><span class="line">    alert(<span class="number">0</span>)</span><br><span class="line">&#125;</span><br><span class="line">btn.addEventListener(<span class="string">&#x27;click&#x27;</span>, handler, <span class="literal">false</span>)</span><br><span class="line">btn.removeEventListener(<span class="string">&#x27;click&#x27;</span>, handler, <span class="literal">false</span>)  <span class="comment">// 有效</span></span><br></pre></td></tr></table></figure>
<p>大多数情况下我们都应该在事件冒泡阶段调用事件处理程序以兼容各大浏览器。最好在只需要在事件到达目标前截获它的时候将事件处理程序添加到事件捕获阶段。</p>
<p><strong>需要注意的是DOM2级事件处理程序和DOM0级事件处理程序一样，事件处理程序中的this也是指向当前元素。</strong></p>
<ul>
<li><h4 id="IE事件处理程序"><a href="#IE事件处理程序" class="headerlink" title="IE事件处理程序"></a>IE事件处理程序</h4></li>
</ul>
<p>IE实现了与DOM2级处理程序中类似的两个方法：<code>attachEvent()和detachEvent()</code>，这两个方法接受相同的两个参数：事件名称和事件处理程序函数。事件处理程序默认被添加到事件冒泡阶段。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> btn = <span class="built_in">document</span>.getElementById(<span class="string">&#x27;myBtn&#x27;</span>)</span><br><span class="line">btn.attachEvent(<span class="string">&#x27;onclick&#x27;</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="comment">// do something</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p><strong>需要注意的是<code>attachEvent()</code>第一个参数为<code>&#39;onclick&#39;</code>而非<code>addEventListener()</code>中的<code>&#39;click&#39;</code></strong></p>
<p><strong>在IE中使用<code>attachEvent()</code>与DOM0级DOM2级方法的主要区别在于事件处理程序函数的作用域不一样。在使用DOM0级DOM2级方法时，事件处理函数的作用域为当前元素所在作用域，this指向当前元素，而在使用<code>attachEvent()</code>方法时，事件处理程序函数的作用域为全局作用域，this指向window。</strong></p>
<p>同样我们亦可以使用<code>attachEvent()</code>方法为一个元素添加多个事件。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> btn = <span class="built_in">document</span>.getElementById(<span class="string">&#x27;myBtn&#x27;</span>)</span><br><span class="line">btn.attachEvent(<span class="string">&#x27;onclick&#x27;</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="comment">// do something</span></span><br><span class="line">    alert(<span class="number">0</span>)</span><br><span class="line">&#125;)</span><br><span class="line">btn.attachEvent(<span class="string">&#x27;onclick&#x27;</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="comment">// do something</span></span><br><span class="line">    alert(<span class="number">1</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p><strong>不过需要注意的是，与DOM事件处理不同，这些事件处理程序并不是按照他们添加的顺序依次执行，而是以相反的顺序执行</strong>。所以先弹出1，再弹出0。</p>
<p>与DOM事件处理程序一样，通过<code>attachEvent()</code>添加的事件也只能使用<code>detachEvent()</code>方法移除，参数必须一模一样。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> btn = <span class="built_in">document</span>.getElementById(<span class="string">&#x27;myBtn&#x27;</span>)</span><br><span class="line"><span class="keyword">var</span> handler = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="comment">// do something</span></span><br><span class="line">    alert(<span class="number">0</span>)</span><br><span class="line">&#125;</span><br><span class="line">btn.attachEvent(<span class="string">&#x27;onclick&#x27;</span>, handler)</span><br><span class="line">btn.detachEvent(<span class="string">&#x27;onclick&#x27;</span>, handler)</span><br></pre></td></tr></table></figure>

<p>在所有事件处理程序中HTML事件处理程序和DOM0级事件处理程序兼容所有浏览器，DOM2级事件处理程序兼容IE9+、Firefox、Chrome和OPera，IE事件处理程序兼容IE8及以下，不过现在大部分公司都不会兼容IE8及以下，所以广泛使用的还是DOM0级和DOM2级事件处理程序。</p>
<h3 id="三、事件对象"><a href="#三、事件对象" class="headerlink" title="三、事件对象"></a>三、事件对象</h3><p>在触发DOM上的某个事件时，会产生一个事件对象event，这个对象中包含所有与事件对象有关的信息。包括导致事件的元素、事件的类型等等。所有浏览器都支持event，但支持方式不同。</p>
<ul>
<li><h4 id="DOM中的事件对象"><a href="#DOM中的事件对象" class="headerlink" title="DOM中的事件对象"></a>DOM中的事件对象</h4><p>兼容DOM的浏览器都会将一个event对象传入到事件处理程序中。无论是DOM0级还是DOM2级事件处理程序。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> btn = <span class="built_in">document</span>.getElementById(<span class="string">&#x27;myBtn&#x27;</span>)</span><br><span class="line">btn.onclick = <span class="function"><span class="keyword">function</span>(<span class="params">event</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(event)</span><br><span class="line">&#125;</span><br><span class="line">btn.addEventListener(<span class="string">&#x27;click&#x27;</span>, <span class="function"><span class="keyword">function</span>(<span class="params">event</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(event)</span><br><span class="line">&#125;, <span class="literal">false</span>)</span><br></pre></td></tr></table></figure>
<p>在通过HTML特性指定的事件处理程序时，同样存在event对象。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;div onclick=<span class="string">&quot;console.log(event)&quot;</span>&gt;&lt;/div&gt;</span><br></pre></td></tr></table></figure>
<p>event对象包含一下常用属性与方法：</p>
</li>
<li><p><code>type</code>：事件类型如click</p>
</li>
<li><p><code>target</code>：事件实际发生的目标</p>
</li>
<li><p><code>preventDefault()</code>：取消事件的默认行为</p>
</li>
<li><p><code>stopPropagation()</code>：取消事件捕获或冒泡</p>
</li>
</ul>
<p>需要注意的是只有在事件处理程序执行期间，event对象才会存在；一旦事件处理程序执行完毕，event对象就会被销毁。</p>
<ul>
<li><h4 id="IE中的事件对象"><a href="#IE中的事件对象" class="headerlink" title="IE中的事件对象"></a>IE中的事件对象</h4>与访问DOM中的event对象不同，访问IE中的event对象取决于事件处理程序。</li>
</ul>
<p>以下是DOM0级事件处理程序时的event：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> btn = <span class="built_in">document</span>.getElementById(<span class="string">&#x27;myBtn&#x27;</span>)</span><br><span class="line">btn.onclick = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> event = <span class="built_in">window</span>.event</span><br><span class="line">    <span class="built_in">console</span>.log(event)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>event对象被看作为window的一个属性。</p>
<p>但是如果事件处理程序使用<code>attachEvent()</code>添加的，那么就会有一个event对象作为参数被传入事件处理函数中。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> btn = <span class="built_in">document</span>.getElementById(<span class="string">&#x27;myBtn&#x27;</span>)</span><br><span class="line">btn.attachEvent(<span class="string">&#x27;onclick&#x27;</span>, <span class="function"><span class="keyword">function</span>(<span class="params">event</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(event)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>如果直接使用HTML事件处理程序，也可以通过event变量访问到event对象。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;div onclick=<span class="string">&quot;console.log(event)&quot;</span>&gt;&lt;/div&gt;</span><br></pre></td></tr></table></figure>
<p>IE中的event对象同时也有一下几个常见的属性及方法：</p>
<ul>
<li><code>type</code></li>
<li><code>srcElement</code>：事件目标，相当于target</li>
<li><code>returnValue</code>：默认为true，设置为false可以取消事件的默认行为，相当于preventDefault()</li>
<li><code>cancelBubble</code>：默认为false，将其设置为true可以取消事件冒泡，相当于stopPropagation()</li>
</ul>
<h3 id="四、事件委托"><a href="#四、事件委托" class="headerlink" title="四、事件委托"></a>四、事件委托</h3><p>当事件处理程序过多时，为了避免我们一个个添加事件处理程序，我们可以考虑使用事件委托。考虑以下代码：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;ul id=<span class="string">&quot;list&quot;</span>&gt;</span><br><span class="line">  &lt;li id=<span class="string">&quot;sayOne&quot;</span>&gt;&lt;/li&gt;</span><br><span class="line">  &lt;li id=<span class="string">&quot;sayTwo&quot;</span>&gt;&lt;/li&gt;</span><br><span class="line">  &lt;li id=<span class="string">&quot;sayThree&quot;</span>&gt;&lt;/li&gt;</span><br><span class="line">&lt;/ul&gt;</span><br></pre></td></tr></table></figure>
<p>现在我们要点击li元素然后执行不同的函数，一般做法是给每一个li元素都添加一个事件处理程序，但是这种做法或导致页面性能下降，因此我们利用事件冒泡，只指定一个事件处理程序，用它来管理所有同类事件，具体实现方法如下：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> list = <span class="built_in">document</span>.getElementById(<span class="string">&quot;list&quot;</span>)</span><br><span class="line">list.addEventListener(<span class="string">&#x27;click&#x27;</span>, <span class="function"><span class="keyword">function</span>(<span class="params">event</span>) </span>&#123;</span><br><span class="line">    <span class="comment">// target为当前点击的元素</span></span><br><span class="line">    <span class="keyword">var</span> target = event.target</span><br><span class="line">    <span class="keyword">switch</span>(target.id) &#123;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;sayOne&#x27;</span>:</span><br><span class="line">            alert(<span class="number">1</span>)</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;sayTwo&#x27;</span>:</span><br><span class="line">            alert(<span class="number">2</span>)</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;sayThree&#x27;</span>:</span><br><span class="line">            alert(<span class="number">3</span>)</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;, <span class="literal">false</span>)</span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://sillywa.com/2018/12/06/DOM/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/logo.png">
      <meta itemprop="name" content="Sillywa">
      <meta itemprop="description" content="个人学习记录博客">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Sillywa's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2018/12/06/DOM/" class="post-title-link" itemprop="url">DOM</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2018-12-06 13:21:43" itemprop="dateCreated datePublished" datetime="2018-12-06T13:21:43+08:00">2018-12-06</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2020-09-23 16:53:21" itemprop="dateModified" datetime="2020-09-23T16:53:21+08:00">2020-09-23</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/JavaScript-%E5%9F%BA%E7%A1%80/" itemprop="url" rel="index"><span itemprop="name">JavaScript 基础</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>所谓DOM就是文档对象模型，我们可以把一个文档的各种元素想象成一个节点树，每一段标记都可以通过树中的一个节点（Node）来表示：HTML元素通过元素节点表示、属性通过属性节点表示、文本通过文本节点表示。总共有12种节点类型，我们需要重点掌握元素节点，属性节点和文本节点。</p>
<!--- more --->

<h3 id="Node类型"><a href="#Node类型" class="headerlink" title="Node类型"></a>Node类型</h3><p>每一个节点都具有一系列公共属性，下面我们列举一下常见的属性：</p>
<ul>
<li><code>nodeType</code>: 显示节点的类型，1代表元素节点、2代表属性节点、3代表文本节点</li>
<li><code>nodeName</code>: 元素节点的标签名，以大写表示</li>
<li><code>tagName</code>: 与<code>nodeName</code>一样</li>
<li><code>nodeValue</code>: 元素节点的值，文本节点和属性节点才有值，元素节点的<code>nodeValue</code>为<code>null</code></li>
<li><code>attributes</code>: 返回属性节点的集合<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">&quot;wrapper&quot;</span> id=<span class="string">&quot;totop&quot;</span>&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line"></span><br><span class="line"><span class="built_in">document</span>.getElementById(<span class="string">&#x27;totop&#x27;</span>).attributes[<span class="string">&quot;id&quot;</span>]  <span class="comment">// 此处是id属性节点，并不是id的值</span></span><br><span class="line"><span class="comment">// 要得到id的值，只需获取该属性节点的值</span></span><br><span class="line"><span class="built_in">document</span>.getElementById(<span class="string">&#x27;totop&#x27;</span>).attributes[<span class="string">&quot;id&quot;</span>].nodeValue</span><br><span class="line"><span class="comment">// 当然一般情况下我们这样获取id的值</span></span><br><span class="line"><span class="built_in">document</span>.getElementById(<span class="string">&#x27;totop&#x27;</span>).id</span><br></pre></td></tr></table></figure></li>
<li><code>firstChild</code>: 表示某个节点的第一个节点</li>
<li><code>lastChild</code>: 表示某个节点的最后一个节点</li>
<li><code>childNodes</code>: 表示某个节点的所有子节点的数组</li>
<li><code>parentNode</code>: 表示某个节点的第一个父节点</li>
<li><code>nextSibling</code>: 下一个兄弟节点</li>
<li><code>previousSibling</code>: 上一个兄弟节点</li>
</ul>
<h3 id="节点操作"><a href="#节点操作" class="headerlink" title="节点操作"></a>节点操作</h3><ol>
<li>创建节点<ul>
<li>创建一个元素节点<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 创建一个div元素</span></span><br><span class="line"><span class="keyword">var</span> div = <span class="built_in">document</span>.createElement(<span class="string">&#x27;div&#x27;</span>)</span><br></pre></td></tr></table></figure></li>
<li>创建一个文本节点<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">var text &#x3D; document.createTextNode(&#39;Hello Word&#39;)</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
<li>添加节点</li>
</ol>
<p>当我们创建了一个个节点之后我们需要把他们组合在一起，即将一个节点添加到另一个节点中。这是我们可以用<code>appendChild()</code>方法，将该节点添加到另一个节点的<code>childNodes</code>末尾。添加节点之后，<code>appendChild()</code>返回新增的节点。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 创建一个div元素</span></span><br><span class="line"><span class="keyword">var</span> div = <span class="built_in">document</span>.createElement(<span class="string">&#x27;div&#x27;</span>)</span><br><span class="line"><span class="keyword">var</span> text = <span class="built_in">document</span>.createTextNode(<span class="string">&#x27;Hello Word&#x27;</span>)</span><br><span class="line">div.appendChild(text)</span><br><span class="line"><span class="comment">// 最后还需要将节点加入到body中</span></span><br><span class="line"><span class="built_in">document</span>.body.appendChild(div)</span><br><span class="line"></span><br><span class="line">div.lastChild == div.appendChild(text)  <span class="comment">// true</span></span><br></pre></td></tr></table></figure>
<ol start="3">
<li>插入节点</li>
</ol>
<p>我们可以用<code>insertBefore()</code>方法来在一个节点之前插入另一个节点，调用该方法的应当是目标节点的父节点，这个方法接受两个参数：要插入的节点和目标节点。插入节点后，被插入的节点会变成目标节点的前一个兄弟节点(<code>previousSibling</code>)，同时返回插入的节点。如果第二个参数是<code>null</code>，则和<code>appendChild()</code>方法一样。</p>
<p>下面是该方法的语法：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">parentElement.insertBefore(newElement, targetElement)</span><br></pre></td></tr></table></figure>
<p>我们不必搞清楚目标元素的父元素是谁，因为<code>targetElement</code>元素的<code>parentNode</code>就是目标元素的父元素</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">targetElement.parentNode.insertBefore(newElement, targetElement)</span><br></pre></td></tr></table></figure>

<ol start="4">
<li>移除节点</li>
</ol>
<ul>
<li><p><code>replaceChild()</code>：该方法替换一个节点的子节点，接受两个参数：第一个为新的节点，第二个为目标节点，返回目标节点并从文档中被移除</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 替换第一个子节点</span></span><br><span class="line">someNode.replaceChild(newNode, someNode.firstChild)</span><br></pre></td></tr></table></figure>
</li>
<li><p><code>removeChild()</code>：该方法接受一个参数，即要移除的节点，返回移除的节点</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 移除第一个子节点</span></span><br><span class="line">someNode.removeChild(someNode.firstChild)</span><br></pre></td></tr></table></figure>
<h3 id="属性操作"><a href="#属性操作" class="headerlink" title="属性操作"></a>属性操作</h3></li>
</ul>
<ol>
<li>获取属性</li>
</ol>
<p>通常情况下我们可以使用<code>getAttribute()</code>方法来获取一个属性节点的值，该方法只有一个参数：要获取的属性的名字</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">someNode.getAttribute(attribute)</span><br></pre></td></tr></table></figure>
<ol start="2">
<li>设置属性</li>
</ol>
<p>当我们需要修改或设置属性时，可以使用<code>setAttribute()</code>方法，该方法接受两个参数：要设置或修改的属性，属性值</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">someNode.setAttribute(attribute, value)</span><br></pre></td></tr></table></figure>
<ol start="3">
<li>移除属性</li>
</ol>
<p>当我们需要移除属性时，可以使用<code>removeAttribute()</code>方法，该方法接受一个参数：要移除的属性</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">someNode.removeAttribute(attribute)</span><br></pre></td></tr></table></figure>
<h3 id="理解元素的子节点"><a href="#理解元素的子节点" class="headerlink" title="理解元素的子节点"></a>理解元素的子节点</h3><p>我们需要注意的是不同浏览器处理子节点的方式是不一样的，以下面代码为例：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">p</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">p</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">p</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>很显然<code>&lt;div&gt;</code>元素有3个子节点，分别是3个<code>&lt;p&gt;</code>元素，但是这种说法只有在IE浏览器中才是正确的。因为在其它浏览器中<code>&lt;div&gt;</code>有7个子节点，增加了4个文本节点（表示<code>&lt;p&gt;</code>元素之间的空隙）。如果像下面这样删除空格，那么所有浏览器都会返回相同数量的子节点。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span><span class="tag">&lt;<span class="name">p</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span><span class="tag">&lt;<span class="name">p</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span><span class="tag">&lt;<span class="name">p</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>因此如果要通过<code>childNodes</code>属性遍历子节点，一定要判断节点类型即<code>nodeType</code>的值，只有当<code>nodeType</code>值为1时，才能进行操作</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>, length = element.childNodes.length; i &lt; length; i++) &#123;</span><br><span class="line">    <span class="keyword">if</span> (element.childNodes[i].nodeType == <span class="number">1</span>) &#123;</span><br><span class="line">        <span class="comment">// do something</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://sillywa.com/2018/12/06/%E5%8E%9F%E7%94%9Fjs%E5%8F%8C%E5%90%91%E6%95%B0%E6%8D%AE%E7%BB%91%E5%AE%9A/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/logo.png">
      <meta itemprop="name" content="Sillywa">
      <meta itemprop="description" content="个人学习记录博客">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Sillywa's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2018/12/06/%E5%8E%9F%E7%94%9Fjs%E5%8F%8C%E5%90%91%E6%95%B0%E6%8D%AE%E7%BB%91%E5%AE%9A/" class="post-title-link" itemprop="url">基于 Object.defineProperty() 的原生js双向数据绑定</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2018-12-06 13:18:38" itemprop="dateCreated datePublished" datetime="2018-12-06T13:18:38+08:00">2018-12-06</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2020-09-23 16:52:46" itemprop="dateModified" datetime="2020-09-23T16:52:46+08:00">2020-09-23</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/JavaScript-%E5%9F%BA%E7%A1%80/" itemprop="url" rel="index"><span itemprop="name">JavaScript 基础</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>前面我们介绍过存储器属性(<a href="/2018/12/06/%E9%87%8D%E6%96%B0%E8%AE%A4%E8%AF%86JS%E5%AF%B9%E8%B1%A1%EF%BC%88%E4%B8%80%EF%BC%89/" title="重新认识JS对象（一）-- 对象及其属性">重新认识JS对象（一）-- 对象及其属性</a>)，以及如何用<code>Object.defineProperty()</code>定义一个存储器属性，今天我们介绍如何用<code>Object.defineProperty()</code>实现双向数据绑定。</p>
<!--- more --->

<p>我们知道一个存储器属性有四个属性描述符：<code>get，set，configurable，enumerable</code>。我们来复习一下如何创建一个存储器属性：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> user = &#123;</span><br><span class="line">    name: <span class="string">&#x27;&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">Object</span>.defineProperty(user, <span class="string">&#x27;nickname&#x27;</span>, &#123;</span><br><span class="line">    configurable: <span class="literal">true</span>,</span><br><span class="line">    enumerable: <span class="literal">true</span>,</span><br><span class="line">    get: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">this</span>.name</span><br><span class="line">    &#125;,</span><br><span class="line">    set: <span class="function"><span class="keyword">function</span>(<span class="params">value</span>) </span>&#123;</span><br><span class="line">        <span class="built_in">this</span>.name = value</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>以上代码我们给<code>user</code>创建了一个名为<code>nickname</code>的存储器属性。</p>
<p>接下来我们改写<code>get</code>和<code>set</code>，让它们与<code>DOM</code>绑定，并实现双向数据绑定，以下为具体实现的伪代码：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&lt;input type=<span class="string">&quot;text&quot;</span> id=<span class="string">&quot;foo&quot;</span>&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">    <span class="keyword">var</span> user = &#123;&#125;</span><br><span class="line">    <span class="built_in">Object</span>.defineProperty(user, <span class="string">&#x27;inputValue&#x27;</span>, &#123;</span><br><span class="line">        configurable: <span class="literal">true</span>,</span><br><span class="line">        get: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">document</span>.getElementById(<span class="string">&#x27;foo&#x27;</span>).value</span><br><span class="line">        &#125;,</span><br><span class="line">        set: <span class="function"><span class="keyword">function</span>(<span class="params">value</span>) </span>&#123;</span><br><span class="line">            <span class="built_in">document</span>.getElementById(<span class="string">&#x27;foo&#x27;</span>).value = value</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>
<p>我们打开控制台，改变<code>user.inputValue</code>的值，会发现<code>input</code>输入框里的值也发生变化；同样我们在<code>input</code>输入框里面输入值，在控制台打印<code>user.inputValue</code>，会发现<code>user.inputValue</code>也发生了变化。这样我们就实现了双向的数据绑定。</p>
<p>如果多个<code>DOM</code>绑定同一个数据，我们可以监听<code>input</code>输入框的<code>keyup</code>事件，只要触发了<code>keyup</code>事件我们就把<code>user.inputValue</code>的值赋给另一个<code>DOM</code>，具体实现如下：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">&lt;input type=<span class="string">&quot;text&quot;</span> id=<span class="string">&quot;foo&quot;</span>&gt;</span><br><span class="line">&lt;p id=<span class="string">&quot;test&quot;</span>&gt;&lt;/p&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">    <span class="keyword">var</span> user = &#123;&#125;</span><br><span class="line">    <span class="built_in">Object</span>.defineProperty(user, <span class="string">&#x27;inputValue&#x27;</span>, &#123;</span><br><span class="line">        configurable: <span class="literal">true</span>,</span><br><span class="line">        get: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">document</span>.getElementById(<span class="string">&#x27;foo&#x27;</span>).value</span><br><span class="line">        &#125;,</span><br><span class="line">        set: <span class="function"><span class="keyword">function</span>(<span class="params">value</span>) </span>&#123;</span><br><span class="line">            <span class="built_in">document</span>.getElementById(<span class="string">&#x27;foo&#x27;</span>).value = value</span><br><span class="line">            <span class="built_in">document</span>.getElementById(<span class="string">&#x27;test&#x27;</span>).innerHTML = value</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">    <span class="built_in">document</span>.getElementById(<span class="string">&#x27;foo&#x27;</span>).addEventListener(<span class="string">&#x27;keyup&#x27;</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="built_in">document</span>.getElementById(<span class="string">&#x27;test&#x27;</span>).innerHTML = user.inputValue</span><br><span class="line">    &#125;)</span><br></pre></td></tr></table></figure>
<p>最后附上源码图片<br><img src="https://user-gold-cdn.xitu.io/2018/3/2/161e673d16d3544a?w=809&h=889&f=png&s=92772"></p>
<p>思考：其实实现双向数据绑定并不一定要用<code>Object.defineProperty()</code>，其主要是运用存储器属性的<code>get和set</code>，以下代码也可以实现双向数据绑定：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&lt;input type=<span class="string">&quot;text&quot;</span> id=<span class="string">&quot;foo&quot;</span>&gt;</span><br><span class="line">&lt;p id=<span class="string">&quot;test&quot;</span>&gt;&lt;/p&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">    <span class="keyword">var</span> user = &#123;</span><br><span class="line">      <span class="keyword">get</span> <span class="title">inputValue</span>() &#123; </span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">document</span>.getElementById(<span class="string">&#x27;foo&#x27;</span>).value</span><br><span class="line">      &#125;,</span><br><span class="line">      <span class="keyword">set</span> <span class="title">inputValue</span>(<span class="params">value</span>) &#123;</span><br><span class="line">        <span class="built_in">document</span>.getElementById(<span class="string">&#x27;foo&#x27;</span>).value = value</span><br><span class="line">        <span class="built_in">document</span>.getElementById(<span class="string">&#x27;test&#x27;</span>).innerHTML = value</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">document</span>.getElementById(<span class="string">&#x27;foo&#x27;</span>).addEventListener(<span class="string">&#x27;keyup&#x27;</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">      <span class="built_in">document</span>.getElementById(<span class="string">&#x27;test&#x27;</span>).innerHTML = user.inputValue</span><br><span class="line">    &#125;)</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://sillywa.com/2018/12/06/%E9%9A%90%E5%BC%8F%E7%B1%BB%E5%9E%8B%E8%BD%AC%E6%8D%A2/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/logo.png">
      <meta itemprop="name" content="Sillywa">
      <meta itemprop="description" content="个人学习记录博客">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Sillywa's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2018/12/06/%E9%9A%90%E5%BC%8F%E7%B1%BB%E5%9E%8B%E8%BD%AC%E6%8D%A2/" class="post-title-link" itemprop="url">隐式类型转换</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2018-12-06 13:11:32" itemprop="dateCreated datePublished" datetime="2018-12-06T13:11:32+08:00">2018-12-06</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2020-09-23 16:52:41" itemprop="dateModified" datetime="2020-09-23T16:52:41+08:00">2020-09-23</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/JavaScript-%E5%9F%BA%E7%A1%80/" itemprop="url" rel="index"><span itemprop="name">JavaScript 基础</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="一、抽象值操作"><a href="#一、抽象值操作" class="headerlink" title="一、抽象值操作"></a>一、抽象值操作</h2><p>在javascript中隐式类型转换总是返回基本类型值，如字符串、数字、布尔值，不会返回对象或者函数。所以我们在介绍隐式类型转换之前首先来看一看字符串、数字、布尔值之间类型转换的基本规则。这里涉及到<code>ToString</code>、<code>ToNumber</code>和<code>ToBoolean</code>，同时我们还会介绍<code>ToPrimitive</code>。</p>
<!--- more --->

<h3 id="（一）ToString"><a href="#（一）ToString" class="headerlink" title="（一）ToString"></a>（一）<code>ToString</code></h3><p><code>ToString</code>负责处理非字符串到字符串的强制类型转换。</p>
<p>(1)基本类型的值转化为字符串的基本规则：</p>
<pre><code>1. null转化为&quot;null&quot;
2. undefined转化为&quot;undefined&quot; 
3. true转化为&quot;true&quot;
4. 数字的字符串转化规则遵循通用规则，不过那些极小或者极大的数值使用指数形式：

var a = 1.07 * 1000 * 1000 * 1000 * 1000 * 1000 * 1000 * 1000
a.toString()  // &quot;1.07e21&quot;</code></pre>
<p>(2)对于普通对象来说，如果没有自定义<code>toString()</code>方法，返回<code>&quot;[object Object]&quot;</code>。如果有自己的<code>toString()</code>方法就会调用该方法并返回值。</p>
<p>(3)数组的<code>toString()</code>返回所有单元字符串化以后再用”,”连接起来：</p>
<pre><code>var a = [1,2,3]
a.toString()  // &quot;1,2,3&quot;</code></pre>
<p>(4)日期、正则、函数也遵循通用规则。</p>
<h3 id="（二）ToNumber"><a href="#（二）ToNumber" class="headerlink" title="（二）ToNumber"></a>（二）<code>ToNumber</code></h3><p>(1)基本类型的值转化为数字的基本规则：</p>
<pre><code>1. null转化为0
2. undefined转化为NaN
3. true转化为1，false转化为0
4. 字符串的处理遵循通用规则

Number(&quot;23&quot;)  // 23
Number(&quot;&quot;)    // 0</code></pre>
<p>(2)对象或者数组首先会被转化为相应的基本类型，如果返回的是非数字的基本类型，再按照以上规则进行转化。其中对象转化为基本类型的时候会使用<code>ToPrimitive</code>操作。</p>
<h3 id="（三）ToPrimitive"><a href="#（三）ToPrimitive" class="headerlink" title="（三）ToPrimitive"></a>（三）<code>ToPrimitive</code></h3><p><code>ToPrimitive</code>操作会首先检查对象是否有<code>valueOf()</code>方法，如果有并且返回基本类型的值，就调用该方法进行类型转化。如果没有就使用<code>toString()</code>返回的值。</p>
<p>如果<code>valueOf()</code>和<code>toString()</code>均不返回基本类型的值，就会产生<code>TypeError</code>错误。</p>
<p>如果不对对象和数组的<code>valueOf()</code>和<code>toString()</code>方法进行重写，那么：</p>
<p>(1)对象的<code>valueOf()</code>返回对象本身，<code>toString()</code>返回<code>&quot;[object Object]&quot;</code></p>
<p>(2)数组的<code>valueOf()</code>返回数组本身，<code>toString()</code>返回所有单元字符串化以后再用”,”连接起来。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> a = &#123;</span><br><span class="line">    name: <span class="string">&#x27;sillywa&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> b = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>]</span><br><span class="line">a.valueOf()   <span class="comment">// &#123; name: &#x27;sillywa&#x27; &#125;</span></span><br><span class="line">a.toString()  <span class="comment">// &quot;[object Object]&quot;</span></span><br><span class="line"></span><br><span class="line">b.valueOf()   <span class="comment">// [1,2,3]</span></span><br><span class="line">b.toString()  <span class="comment">// &quot;1,2,3&quot;</span></span><br></pre></td></tr></table></figure>
<h3 id="（四）ToBoolean"><a href="#（四）ToBoolean" class="headerlink" title="（四）ToBoolean"></a>（四）<code>ToBoolean</code></h3><ol>
<li><code>null</code>转化为<code>false</code><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Boolean</span>(<span class="literal">null</span>)  <span class="comment">// false</span></span><br></pre></td></tr></table></figure></li>
<li><code>undefined</code>转化为<code>false</code><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Boolean</span>(<span class="literal">undefined</span>)  <span class="comment">// false</span></span><br></pre></td></tr></table></figure></li>
<li>除””以外，所有字符串转化为<code>true</code><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Boolean</span>(<span class="string">&quot;&quot;</span>)  <span class="comment">// fasle</span></span><br><span class="line"><span class="built_in">Boolean</span>(<span class="string">&quot;abc&quot;</span>)  <span class="comment">// true</span></span><br><span class="line"><span class="built_in">Boolean</span>(<span class="string">&#x27;0&#x27;</span>)  <span class="comment">// true</span></span><br></pre></td></tr></table></figure></li>
<li>除0（包括+0和-0）和<code>NaN</code>外，所有数字转化为<code>true</code><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Boolean</span>(<span class="number">0</span>)  <span class="comment">// false</span></span><br><span class="line"><span class="built_in">Boolean</span>(<span class="literal">NaN</span>)  <span class="comment">// false</span></span><br><span class="line"><span class="built_in">Boolean</span>(<span class="number">-9</span>)  <span class="comment">// true</span></span><br></pre></td></tr></table></figure></li>
<li>所有对象转化为<code>true</code><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Boolean</span>(&#123;&#125;)  <span class="comment">// true</span></span><br><span class="line"><span class="built_in">Boolean</span>([])  <span class="comment">// true</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 需要注意的是通过new关键字得到的是一个对象</span></span><br><span class="line"><span class="keyword">var</span> a = <span class="keyword">new</span> <span class="built_in">Boolean</span>(<span class="literal">false</span>)</span><br><span class="line"><span class="keyword">var</span> b = <span class="keyword">new</span> <span class="built_in">Number</span>(<span class="number">0</span>)</span><br><span class="line"><span class="keyword">var</span> c = <span class="keyword">new</span> <span class="built_in">String</span>(<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"><span class="keyword">var</span> d = <span class="built_in">Boolean</span>(a &amp;&amp; b &amp;&amp; c)</span><br><span class="line">d   <span class="comment">// true</span></span><br></pre></td></tr></table></figure>
<h2 id="二、隐式类型转化"><a href="#二、隐式类型转化" class="headerlink" title="二、隐式类型转化"></a>二、隐式类型转化</h2><h3 id="（一）字符串和数字之间的隐式类型转化"><a href="#（一）字符串和数字之间的隐式类型转化" class="headerlink" title="（一）字符串和数字之间的隐式类型转化"></a>（一）字符串和数字之间的隐式类型转化</h3>(1)数字转化为字符串</li>
</ol>
<p>+运算符既能用于数字相加，也能用于字符串拼接。那么javascript是怎么判断我们要执行那个操作的呢？例如：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> a = <span class="string">&#x27;42&#x27;</span></span><br><span class="line"><span class="keyword">var</span> b = <span class="string">&#x27;0&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> c = <span class="number">42</span></span><br><span class="line"><span class="keyword">var</span> d = <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> e = <span class="number">42</span></span><br><span class="line"><span class="keyword">var</span> f = <span class="string">&#x27;0&#x27;</span></span><br><span class="line"></span><br><span class="line">a + b  <span class="comment">// &quot;420&quot;</span></span><br><span class="line">c + d  <span class="comment">// 42</span></span><br><span class="line">e + f  <span class="comment">// &quot;420&quot;</span></span><br></pre></td></tr></table></figure>
<p>以上代码不难理解，通常我们认为+运算符两边只要有一个操作数是字符串就会执行字符串的拼接操作，但是实际情况更为复杂，例如：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> a = [<span class="number">1</span>,<span class="number">2</span>]</span><br><span class="line"><span class="keyword">var</span> b = [<span class="number">3</span>,<span class="number">4</span>]</span><br><span class="line">a + b  <span class="comment">// &quot;1,23,4&quot;</span></span><br></pre></td></tr></table></figure>
<p><code>a,b</code>都不是字符串，但是它们都被转化为字符串进行拼接操作，原因何在？</p>
<p>简单的理解应当是如果+运算符其中一个是字符串或者可以通过<code>ToPrimitive</code>（针对于对象，包括数组）转化为字符串，则执行字符串的拼接；否则执行数字相加。</p>
<p><em style="color:red">需要注意的是如果是 <code>+ &#39;42&#39;</code>代表强制类型转化为数字，即 <code>42</code>。</em></p>
<p>(2)字符串转化为数字</p>
<p>- , * , /都可以用来将字符串转化为数字，其规则与+类似</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> a = <span class="string">&#x27;3.14&#x27;</span></span><br><span class="line"><span class="keyword">var</span> b = a - <span class="number">0</span></span><br><span class="line">b  <span class="comment">// 3.14</span></span><br></pre></td></tr></table></figure>
<p>同样对于对象和数组也是一样</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> a = [<span class="number">2</span>]</span><br><span class="line"><span class="keyword">var</span> b = [<span class="number">1</span>]</span><br><span class="line">a - b   <span class="comment">// 1</span></span><br></pre></td></tr></table></figure>
<p>为了执行减法运算，<code>a、b</code>都需要被转化为数字，首先通过<code>ToPrimitive</code>转化为字符串再转化为数字。</p>
<h3 id="（二）布尔值到数字的隐式类型转化"><a href="#（二）布尔值到数字的隐式类型转化" class="headerlink" title="（二）布尔值到数字的隐式类型转化"></a>（二）布尔值到数字的隐式类型转化</h3><p>简单举了例子：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span> + <span class="literal">false</span>  <span class="comment">// 1</span></span><br><span class="line"><span class="number">1</span>+ <span class="literal">true</span>  <span class="comment">// 2</span></span><br></pre></td></tr></table></figure>
<h3 id="（三）隐式类型转化为布尔值"><a href="#（三）隐式类型转化为布尔值" class="headerlink" title="（三）隐式类型转化为布尔值"></a>（三）隐式类型转化为布尔值</h3><p>以下几种情况会发生隐式类型转化为布尔值</p>
<ol>
<li><code>if(..)</code>条件判断语句</li>
<li><code>for()</code>中的条件判断</li>
<li><code>while()</code>和<code>do..while(..)</code>中的条件判断</li>
<li><code>? :</code> 三目运算符中的条件判断</li>
<li>逻辑运算符 <code>|| </code>和<code> &amp;&amp;</code> 左边的操作数</li>
</ol>
<h3 id="（四）-和-amp-amp"><a href="#（四）-和-amp-amp" class="headerlink" title="（四）|| 和 &amp;&amp;"></a>（四）<code>|| 和 &amp;&amp;</code></h3><p>ES5规范中有如下描述</p>
<blockquote>
<p><code>&amp;&amp;</code>和 <code>||</code> 运算符并不一定返回布尔值，而是两个操作数其中一个的值</p>
</blockquote>
<p>例如：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> a = <span class="number">42</span></span><br><span class="line"><span class="keyword">var</span> b = <span class="string">&#x27;abc&#x27;</span></span><br><span class="line"><span class="keyword">var</span> c = <span class="literal">null</span></span><br><span class="line"></span><br><span class="line">a || b  <span class="comment">// 42</span></span><br><span class="line">a &amp;&amp; b  <span class="comment">// &#x27;abc&#x27;</span></span><br><span class="line"></span><br><span class="line">c || b  <span class="comment">// &#x27;abc&#x27;</span></span><br><span class="line">c &amp;&amp; b  <span class="comment">// null</span></span><br></pre></td></tr></table></figure>
<p><code>|| 和 &amp;&amp;</code> 首先会对第一个操作数进行条件判断，如果其不是布尔值，会被转化为布尔值，在进行判断。</p>
<p>对于 <code>||</code> 如果第一个操作数返回true则返回第一个操作数的值，如果第一个操作数返回false就返回第二个操作数的值。</p>
<p>对于 <code>&amp;&amp;</code> 如果第一个操作数返回true则返回第二个操作数的值，如果第一个操作数返回false就返回第一个操作数的值。</p>
<p>本篇就介绍到这里，下篇介绍隐式类型转换之(宽松相等和严格相等)。</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://sillywa.com/2018/12/06/%E9%87%8D%E6%96%B0%E8%AE%A4%E8%AF%86JS%E5%AF%B9%E8%B1%A1%EF%BC%88%E4%B8%89%EF%BC%89/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/logo.png">
      <meta itemprop="name" content="Sillywa">
      <meta itemprop="description" content="个人学习记录博客">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Sillywa's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2018/12/06/%E9%87%8D%E6%96%B0%E8%AE%A4%E8%AF%86JS%E5%AF%B9%E8%B1%A1%EF%BC%88%E4%B8%89%EF%BC%89/" class="post-title-link" itemprop="url">重新认识JS对象（三）-- 原型及原型链</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2018-12-06 13:07:40" itemprop="dateCreated datePublished" datetime="2018-12-06T13:07:40+08:00">2018-12-06</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2020-09-23 16:53:02" itemprop="dateModified" datetime="2020-09-23T16:53:02+08:00">2020-09-23</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/JavaScript-%E5%9F%BA%E7%A1%80/" itemprop="url" rel="index"><span itemprop="name">JavaScript 基础</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="一、原型检测"><a href="#一、原型检测" class="headerlink" title="一、原型检测"></a>一、原型检测</h2><p>javascript中提供<code>Object.getPrototypeOf()</code>方法来获得对象的直接原型。</p>
<!--- more --->

<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Person</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">this</span>.name = <span class="string">&#x27;sillywa&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> person1 = <span class="keyword">new</span> Person()</span><br><span class="line"><span class="built_in">Object</span>.getPrototypeOf(person1)  <span class="comment">// &#123;constructor: ƒ Person()&#125;</span></span><br><span class="line"><span class="built_in">Object</span>.getPrototypeOf(person1.__proto__)  <span class="comment">// Object.prototype</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> person = &#123;</span><br><span class="line">    name: <span class="string">&#x27;sillywa&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> person2 = <span class="built_in">Object</span>.create(person)</span><br><span class="line"><span class="built_in">Object</span>.getPrototypeOf(person2)  <span class="comment">// &#123;name: &quot;sillywa&quot;&#125;</span></span><br></pre></td></tr></table></figure>
<p>javascript有以下几种方法检测一个对象的原型：</p>
<ol>
<li><code>isPrototypeOf()</code>：检测一个对象是否是另一个对象的原型</li>
<li><code>obj.constructor.prototype</code>：检测非<code>Object.create()</code>创建的对象的原型<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> obj1 = &#123;</span><br><span class="line">    name: <span class="string">&#x27;sillywa&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> obj2 = <span class="built_in">Object</span>.create(obj1)</span><br><span class="line"></span><br><span class="line"><span class="comment">// isPrototypeOf()方法</span></span><br><span class="line"><span class="built_in">Object</span>.prototype.isPrototypeOf(obj1)  <span class="comment">// true</span></span><br><span class="line">obj1.isPrototypeOf(obj2)  <span class="comment">// true</span></span><br><span class="line"><span class="built_in">Object</span>.prototype.isPrototypeOf(obj2)  <span class="comment">// true</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// obj.constructor.prototype</span></span><br><span class="line">obj1.constructor.prototype === <span class="built_in">Object</span>.prototype  <span class="comment">// true</span></span><br><span class="line"><span class="comment">// obj1是obj2的原型，以下等式应为true</span></span><br><span class="line">obj2.constructor.prototype === obj1  <span class="comment">// false</span></span><br><span class="line"><span class="comment">// 而实际上</span></span><br><span class="line">obj2.constructor.prototype === <span class="built_in">Object</span>.prototype  <span class="comment">// true</span></span><br></pre></td></tr></table></figure>
以上代码中<code>obj1</code>是<code>obj2</code>的原型，<code>obj2.constructor.prototype === obj1</code>应为<code>true</code>但是实际上却是<code>false</code>，因为<code>obj2</code>的<code>__proto__</code>里面并没有一个<code>constructor</code>属性，<code>obj2.constructor</code>实际上是<code>obj1</code>的<code>__proto__</code>里面的<code>constructor</code>，所以<code>obj2.constructor.prototype === Object.prototype</code>。<br><img src="https://user-gold-cdn.xitu.io/2018/2/2/161555a08b89f7c8?w=501&h=377&f=png&s=40282"><h2 id="二、constructor、-proto-与prototype之间的关系"><a href="#二、constructor、-proto-与prototype之间的关系" class="headerlink" title="二、constructor、__proto__与prototype之间的关系"></a>二、<code>constructor</code>、<code>__proto__</code>与<code>prototype</code>之间的关系</h2>在javascript中我们每创建一个对象，该对象都会获得一个<code>__proto__</code>属性（该属性是个对象），该属性指向创建该对象的<code>构造函数的原型</code>即<code>prototype</code>，同时<code>__proto__</code>对象有一个<code>constructor</code>属性指向该构造函数。这里我们需要注意的是只有函数才有<code>prototype</code>，每个对象（函数也是对象）都有<code>__proto__</code>，<code>Object</code>本身是个构造函数。举例来说：<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> obj = <span class="keyword">new</span> <span class="built_in">Object</span>()</span><br><span class="line"><span class="comment">// 也可以使用对象字面量创建，但使用Object.create()情况会不一样</span></span><br><span class="line"><span class="comment">// Object本身是个构造函数</span></span><br><span class="line"><span class="built_in">Object</span> <span class="keyword">instanceof</span> <span class="built_in">Function</span>  <span class="comment">// true</span></span><br><span class="line">obj.__proto__ === <span class="built_in">Object</span>.prototype  <span class="comment">// true</span></span><br><span class="line">obj.__proto__.constructor === <span class="built_in">Object</span>  <span class="comment">// true</span></span><br><span class="line"><span class="comment">// 我们一般习惯这样写</span></span><br><span class="line">obj.constructor === <span class="built_in">Object</span>  <span class="comment">// true</span></span><br></pre></td></tr></table></figure>
当我们访问<code>obj.constructor</code>的时候，<code>obj</code>本身是没有<code>constructor</code>属性的，但属性访问会沿着<code>__proto__</code>向上查找，即在<code>obj.__proto__</code>里面寻找<code>constructor</code>属性，如果找到了就返回值，如果未找到则继续向上查找直到<code>obj.__proto__.__proto__...(__proto__) === null </code>为止，没有找到则返回undefined。这样由<code>__proto__</code>构成的一条查找属性的线称为‘原型链’。<h2 id="三、进一步探讨"><a href="#三、进一步探讨" class="headerlink" title="三、进一步探讨"></a>三、进一步探讨</h2>我们知道JS是单继承的，<code>Object.prototype</code>是原型链的顶端，所有对象从它继承了包括<code>toString</code>等等方法和属性。</li>
</ol>
<p>前面我们说到<code>Object</code>本身是构造函数，那么它继承了<code>Function.prototype</code>;<code>Function</code>也是对象，继承了<code>Object.prototype</code>。这里就有一个鸡和蛋的问题：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Object</span> <span class="keyword">instanceof</span> <span class="built_in">Function</span>  <span class="comment">// true</span></span><br><span class="line"><span class="built_in">Function</span> <span class="keyword">instanceof</span> <span class="built_in">Object</span>  <span class="comment">// true</span></span><br></pre></td></tr></table></figure>
<p>以下是ES规范的解释：</p>
<blockquote>
<p><code>Function</code>本身就是函数，<code>Function.__proto__</code>是标准的内置对象<code>Function.prototype</code>。<br><code>Function.prototype.__proto__</code>是标准的内置对象<code>Object.prototype</code>。</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Person</span>(<span class="params">name</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">this</span>.name = name</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> person1 = <span class="keyword">new</span> Person(<span class="string">&#x27;sillywa&#x27;</span>)</span><br></pre></td></tr></table></figure>
<p><img src="https://user-gold-cdn.xitu.io/2018/2/2/161558d58482d19c?w=826&h=253&f=png&s=20926"></p>
<p>总的来说：先有<code>Object.prototype</code>（原型链顶端），<code>Function.prototype</code>继承<code>Object.prototype</code>而产生，最后，<code>Function</code>和<code>Object</code>和其它构造函数继承<code>Function.prototype</code>而产生。</p>
<h2 id="四、Object-create"><a href="#四、Object-create" class="headerlink" title="四、Object.create()"></a>四、<code>Object.create()</code></h2><p>我们知道通过<code>Object.create()</code>创建的对象实际上等于将该对象的<code>__proto__</code>指向<code>Object.create()</code>里面的参数对象，那么当涉及到原型时它是怎么工作的呢？</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> a = &#123;</span><br><span class="line">    name: <span class="string">&#x27;sillywa&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> b = <span class="built_in">Object</span>.create(a)</span><br><span class="line"></span><br><span class="line">b.__proto__ === <span class="built_in">Object</span>.prototype  <span class="comment">// false</span></span><br><span class="line">b.__proto__ === a  <span class="comment">// true</span></span><br><span class="line">b.__proto__.constructor === <span class="built_in">Object</span>  <span class="comment">// true</span></span><br><span class="line">b.__proto__.hasOwnProperty(<span class="string">&#x27;constructor&#x27;</span>)  <span class="comment">// false</span></span><br></pre></td></tr></table></figure>
<p>下面我们来具体看一看当<code>var b = Object.create(a)</code>到底发生了什么，以下实在浏览器中的结果：<br><img src="https://user-gold-cdn.xitu.io/2018/2/2/161555a08b89f7c8?w=501&h=377&f=png&s=40282"><br>我们可以看到当<code>var b = Object.create(a)</code>实际上是把<code>b</code>的<code>__proto__</code>指向了<code>a</code>。当访问<code>b.constructor</code>时，实际上访问的是<code>b.__proto__.__proto__.constructor</code>。</p>
<h2 id="五、实例与总结"><a href="#五、实例与总结" class="headerlink" title="五、实例与总结"></a>五、实例与总结</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Person</span>(<span class="params">name</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">this</span>.name = name</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> person1 = <span class="keyword">new</span> Person(<span class="string">&#x27;sillywa&#x27;</span>)</span><br><span class="line"></span><br><span class="line">person1.__proto__ === Person.prototype</span><br><span class="line">person1.__proto__.__proto__ === Person.prototype.__proto__</span><br><span class="line">person1.__proto__.__proto__ === <span class="built_in">Object</span>.prototype</span><br><span class="line">Person.prototype.__proto__ === <span class="built_in">Object</span>.prototype </span><br><span class="line">person1.__proto__.__proto__.__proto__ === <span class="literal">null</span></span><br><span class="line"></span><br><span class="line">Person.__proto__ === <span class="built_in">Function</span>.prototype</span><br></pre></td></tr></table></figure>
<p>以上均返回<code>true</code>，前五个等式和第一部分内容相关，最后一个等式为第二部分内容，<strong>需要注意的是IE浏览器里面并没有实现<code>__proto__</code>，为了便于理解我们可以这样解释，但是最好不要在实际中使用</strong></p>
<p><img src="https://user-gold-cdn.xitu.io/2018/2/2/161557f207fff784?w=823&h=242&f=png&s=21059"></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://sillywa.com/2018/12/06/%E9%87%8D%E6%96%B0%E8%AE%A4%E8%AF%86JS%E5%AF%B9%E8%B1%A1%EF%BC%88%E4%BA%8C%EF%BC%89/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/logo.png">
      <meta itemprop="name" content="Sillywa">
      <meta itemprop="description" content="个人学习记录博客">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Sillywa's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2018/12/06/%E9%87%8D%E6%96%B0%E8%AE%A4%E8%AF%86JS%E5%AF%B9%E8%B1%A1%EF%BC%88%E4%BA%8C%EF%BC%89/" class="post-title-link" itemprop="url">重新认识JS对象（二）-- 对象及其属性</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2018-12-06 13:05:21" itemprop="dateCreated datePublished" datetime="2018-12-06T13:05:21+08:00">2018-12-06</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2020-09-23 16:52:54" itemprop="dateModified" datetime="2020-09-23T16:52:54+08:00">2020-09-23</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/JavaScript-%E5%9F%BA%E7%A1%80/" itemprop="url" rel="index"><span itemprop="name">JavaScript 基础</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>前面介绍了如何创建对象，对象的存储器属性以及对象的特性（属性描述符），今天我们接着前面的来介绍对象及其属性。</p>
<!--- more --->

<h2 id="一、删除属性"><a href="#一、删除属性" class="headerlink" title="一、删除属性"></a>一、删除属性</h2><p><code>delete</code> 运算符可以用来删除对象的属性，它的操作数应当是个属性访问表达式（如果是个非法的操作数，早严格模式下会报错）。但它只能删除对象的自有属性，不能删除在原型对象上的属性，如果需要删除原型对象上的属性，需要在原型里面进行操作。</p>
<p>当<code>delete</code> 删除属性成功或者没有任何副作用时，返回<code>true</code>。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Person</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">this</span>.name = <span class="string">&#x27;sillywa&#x27;</span></span><br><span class="line">    <span class="built_in">this</span>.age = <span class="number">12</span></span><br><span class="line">&#125;</span><br><span class="line">Person.prototype.sex = <span class="string">&#x27;boy&#x27;</span></span><br><span class="line"><span class="keyword">var</span> person1 = <span class="keyword">new</span> Person()</span><br><span class="line"></span><br><span class="line"><span class="keyword">delete</span> person1.name  <span class="comment">// 删除name属性，返回true</span></span><br><span class="line">person1.name  <span class="comment">// undefined</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 试图删除原型上的属性</span></span><br><span class="line"><span class="keyword">delete</span> person1.sex  <span class="comment">// 无法删除，没有任何副作用，返回true</span></span><br><span class="line">person1.sex  <span class="comment">// &#x27;boy&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 删除sex属性</span></span><br><span class="line"><span class="keyword">delete</span> Person.prototype.sex</span><br><span class="line">person1.sex  <span class="comment">// undefined</span></span><br><span class="line"></span><br><span class="line">Person.prototype.sex = <span class="string">&#x27;boy&#x27;</span></span><br><span class="line"><span class="comment">// 或者可以这样，和上面的效果一样</span></span><br><span class="line"><span class="keyword">delete</span> person1.__proto__.sex</span><br></pre></td></tr></table></figure>
<p><code>delete</code> 不能删除那些<code>configurable</code>为<code>false</code>的属性，也不能删除通过变量声明或者函数声明创建的全局对象的属性。在严格模式下删除不可配置的属性会报错，非严格模式下返回<code>false</code>。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">delete</span> <span class="built_in">Object</span>.prototype  <span class="comment">// 不能删除</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> x = <span class="number">1</span></span><br><span class="line"><span class="keyword">delete</span> <span class="built_in">this</span>.x  <span class="comment">// 不能删除</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">f</span>(<span class="params"></span>) </span>&#123;&#125;</span><br><span class="line"><span class="keyword">delete</span> <span class="built_in">this</span>.f  <span class="comment">// 不能删除</span></span><br></pre></td></tr></table></figure>
<h2 id="二、检测属性"><a href="#二、检测属性" class="headerlink" title="二、检测属性"></a>二、检测属性</h2><p>有三种方法可以检测对象中是否含有某个属性：</p>
<ol>
<li><code>in 运算符</code>：  检测属性在自身及原型链上是否存在</li>
<li><code>hasOwnProperty()</code>：  检测属性是否为自有属性（不包括继承属性）</li>
<li><code>propertyIsEnumerable()</code>：  检测属性为自有属性切可枚举<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Person</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">this</span>.name = <span class="string">&#x27;sillywa&#x27;</span></span><br><span class="line">    <span class="built_in">this</span>.age = <span class="number">12</span></span><br><span class="line">&#125;</span><br><span class="line">Person.prototype.sex = <span class="string">&#x27;boy&#x27;</span></span><br><span class="line"><span class="keyword">var</span> person1 = <span class="keyword">new</span> Person()</span><br><span class="line"><span class="comment">// in 运算符</span></span><br><span class="line"><span class="string">&#x27;age&#x27;</span> <span class="keyword">in</span> person1  <span class="comment">// true</span></span><br><span class="line"><span class="string">&#x27;sex&#x27;</span> <span class="keyword">in</span> person1  <span class="comment">// true</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// hasOwnProperty()</span></span><br><span class="line">person1.hasOwnProperty(<span class="string">&#x27;age&#x27;</span>)  <span class="comment">// true</span></span><br><span class="line">person1.hasOwnProperty(<span class="string">&#x27;sex&#x27;</span>)  <span class="comment">// false</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// propertyIsEnumerable</span></span><br><span class="line">person1.propertyIsEnumerable(<span class="string">&#x27;age&#x27;</span>)  <span class="comment">// true</span></span><br><span class="line">person1.propertyIsEnumerable(<span class="string">&#x27;sex&#x27;</span>)  <span class="comment">// false</span></span><br><span class="line"><span class="comment">// 定义一个不可枚举的属性college</span></span><br><span class="line"><span class="built_in">Object</span>.defineProperty(person1,<span class="string">&#x27;college&#x27;</span>,&#123;</span><br><span class="line">    value: <span class="string">&#x27;wuhan&#x27;</span>,</span><br><span class="line">    writable: <span class="literal">true</span>,</span><br><span class="line">    enumerable: <span class="literal">false</span></span><br><span class="line">&#125;)</span><br><span class="line">person1.propertyIsEnumerable(<span class="string">&#x27;college&#x27;</span>)  <span class="comment">// false</span></span><br></pre></td></tr></table></figure>
判断一个对象中是否存在某个属性不能用<code>!=undefined</code>，因为即使这个属性不存在也会返回<code>undefined</code>。<h2 id="三、枚举属性"><a href="#三、枚举属性" class="headerlink" title="三、枚举属性"></a>三、枚举属性</h2>枚举属性即遍历对象中所有的属性包括可枚举属性与不可枚举属性。</li>
</ol>
<p>遍历可枚举属性有以下两种方法：</p>
<ol>
<li><code>for in循环</code>：  遍历对象中所有可枚举的属性，包括<strong>自有属性和继承属性</strong>。可以配合<code>hasOwnProperty()</code>方法得到自有属性。</li>
<li><code>Object.keys()</code>：  遍历对象中所有可枚举的<strong>自有属性</strong>，返回由这些属性组成的数组。</li>
</ol>
<p>遍历不可枚举的属性有一种方法：</p>
<ol>
<li><code>Object.getOwnPropertyNames()</code> 它和<code>Object.keys()</code>类似，返回对象所有自有属性的名称，<strong>包括不可枚举的属性</strong><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Person</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">this</span>.name = <span class="string">&#x27;sillywa&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line">Person.prototype.sex = <span class="string">&#x27;boy&#x27;</span></span><br><span class="line"><span class="keyword">var</span> person1 = <span class="keyword">new</span> Person()</span><br><span class="line"><span class="built_in">Object</span>.defineProperty(person1,<span class="string">&#x27;college&#x27;</span>,&#123;</span><br><span class="line">    value: <span class="string">&#x27;wuhan&#x27;</span>,</span><br><span class="line">    writable: <span class="literal">true</span>,</span><br><span class="line">    enumerable: <span class="literal">false</span></span><br><span class="line">&#125;)</span><br><span class="line"><span class="comment">// person1有三个属性，一个可枚举自有属性name，一个可枚举继承属性sex，一个不可枚举自有属性college</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 返回可枚举的自有属性和继承属性</span></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">var</span> prop <span class="keyword">in</span> person1) &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(prop)   <span class="comment">// &#x27;name&#x27;,&#x27;sex&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 仅仅返回可枚举的自有属性</span></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">var</span> prop <span class="keyword">in</span> person1) &#123;</span><br><span class="line">    <span class="keyword">if</span> (person1.hasOwnProperty(prop)) &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(prop)   <span class="comment">// &#x27;name&#x27;</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 返回可枚举的自有属性组成的数组</span></span><br><span class="line"><span class="built_in">Object</span>.keys(person1)  <span class="comment">// [&#x27;name&#x27;]</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 返回所有自有属性组成的数组，包括不可枚举的属性</span></span><br><span class="line"><span class="built_in">Object</span>.getOwnPropertyNames(person1)  <span class="comment">// [&#x27;name&#x27;,&#x27;college&#x27;]</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

</li>
</ol>
<p>至此对象及其属性介绍完毕，下一章将讨论对象的<a href="/2018/12/06/%E9%87%8D%E6%96%B0%E8%AE%A4%E8%AF%86JS%E5%AF%B9%E8%B1%A1%EF%BC%88%E4%B8%89%EF%BC%89/" title="原型及原型链">原型及原型链</a></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://sillywa.com/2018/12/06/%E9%87%8D%E6%96%B0%E8%AE%A4%E8%AF%86JS%E5%AF%B9%E8%B1%A1%EF%BC%88%E4%B8%80%EF%BC%89/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/logo.png">
      <meta itemprop="name" content="Sillywa">
      <meta itemprop="description" content="个人学习记录博客">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Sillywa's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2018/12/06/%E9%87%8D%E6%96%B0%E8%AE%A4%E8%AF%86JS%E5%AF%B9%E8%B1%A1%EF%BC%88%E4%B8%80%EF%BC%89/" class="post-title-link" itemprop="url">重新认识JS对象（一）-- 对象及其属性</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2018-12-06 13:02:20" itemprop="dateCreated datePublished" datetime="2018-12-06T13:02:20+08:00">2018-12-06</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2020-09-23 16:53:10" itemprop="dateModified" datetime="2020-09-23T16:53:10+08:00">2020-09-23</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/JavaScript-%E5%9F%BA%E7%A1%80/" itemprop="url" rel="index"><span itemprop="name">JavaScript 基础</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="一、创建对象"><a href="#一、创建对象" class="headerlink" title="一、创建对象"></a>一、创建对象</h2><p>javascript中有三种方法可以创建一个对象：</p>
<!--- more --->

<ol>
<li><p>对象字面量</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> obj = &#123;</span><br><span class="line">    name: <span class="string">&#x27;jack&#x27;</span>,</span><br><span class="line">    age: <span class="number">12</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>new 构造函数</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> obj = <span class="keyword">new</span> <span class="built_in">Object</span>()</span><br><span class="line"><span class="keyword">var</span> obj1 = <span class="keyword">new</span> <span class="built_in">Object</span>(&#123;</span><br><span class="line">    name: <span class="string">&#x27;jack&#x27;</span>,</span><br><span class="line">    age: <span class="number">12</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
</li>
<li><p><code>Object.create()</code></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> obj = <span class="built_in">Object</span>.create(&#123;</span><br><span class="line">    name: <span class="string">&#x27;jack&#x27;</span>,</span><br><span class="line">    age: <span class="number">12</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure></li>
</ol>
<p><strong>需要注意的是通过<code>Object.create()</code>创建的对象实际上等于将该对象的<code>__proto__</code>指向<code>Object.create()</code>里面的参数对象，而<code>obj</code>本身是个空对象。</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> obj = <span class="built_in">Object</span>.create(&#123;</span><br><span class="line">    name: <span class="string">&#x27;jack&#x27;</span>,</span><br><span class="line">    age: <span class="number">12</span></span><br><span class="line">&#125;)</span><br><span class="line"><span class="comment">// 等价于 obj.__proto__ = &#123; name: &#x27;jack&#x27;, age: 12 &#125;</span></span><br><span class="line"><span class="built_in">console</span>.log(obj)  <span class="comment">// &#123;&#125;</span></span><br><span class="line"><span class="built_in">console</span>.log(obj.__proto__)  <span class="comment">// &#123; name: &#x27;jack&#x27;, age: 12 &#125;</span></span><br><span class="line">obj.toString()   <span class="comment">// &#x27;[object Object]&#x27;</span></span><br></pre></td></tr></table></figure>
<p>如果往<code>Object.create()</code>里面传入的是<code>null</code>，则创建的对象不继承<code>Object</code>的任何方法及属性。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> obj = <span class="built_in">Object</span>.create(<span class="literal">null</span>)</span><br><span class="line"><span class="built_in">console</span>.log(obj)  <span class="comment">// &#123;&#125;</span></span><br><span class="line"><span class="built_in">console</span>.log(obj.__proto__)  <span class="comment">// undefined</span></span><br><span class="line">obj.toString()  <span class="comment">// 报错</span></span><br></pre></td></tr></table></figure>
<p>如果想创建一个空对象，需要传入<code>Object.prototype</code></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> obj = <span class="built_in">Object</span>.create(<span class="built_in">Object</span>.prototype)</span><br><span class="line"><span class="comment">// 和 &#123;&#125; 、new Object()一样</span></span><br></pre></td></tr></table></figure>
<h2 id="二、对象的属性"><a href="#二、对象的属性" class="headerlink" title="二、对象的属性"></a>二、对象的属性</h2><p>我们知道，对象的属性是由名字、值和一组特性组成（属性的特性待会介绍）。在ES5中属性值可以用一个或两个方法代替，这两个方法就是<code>getter</code>和<code>setter</code>。由<code>getter</code>和<code>setter</code>定义的属性称为“存储器属性”，它不同于数据类型的属性，数据属性只有一个简单的值。我们重点讲解存储器属性。</p>
<p>当我们查询存储器属性时会调用<code>getter</code>方法（无参数）。这个方法返回值就是属性存取表达式返回的值。</p>
<p>当我们设置存储器属性时会调用<code>setter</code>方法（有参数）。这个方法修改存储器属性的值。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> obj = &#123;</span><br><span class="line">    num: <span class="number">12</span>,</span><br><span class="line">    age: <span class="number">13</span>,</span><br><span class="line">    get num1 () &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">this</span>.num</span><br><span class="line">    &#125;,</span><br><span class="line">    set num1 (value) &#123;</span><br><span class="line">        <span class="built_in">this</span>.num = value</span><br><span class="line">    &#125;,</span><br><span class="line">    get age1 () &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">this</span>.age</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">obj.num1   <span class="comment">// 12</span></span><br><span class="line">obj.num1 = <span class="number">120</span></span><br><span class="line">obj.num1  <span class="comment">// 120</span></span><br><span class="line"></span><br><span class="line">obj.age1  <span class="comment">// 13</span></span><br><span class="line">obj.age1 = <span class="number">130</span></span><br><span class="line">obj.age1  <span class="comment">// 13</span></span><br></pre></td></tr></table></figure>
<p>存储器属性定义为一个或者两个和属性同名的函数，这个函数定义没有使用<code>function</code>关键字而是使用<code>get</code>和<code>set</code>。</p>
<p>可以看出如果该属性只有<code>getter</code>方法则只能读取该属性不能设置该属性，同样如果只有<code>setter</code>方法就只能设置该属性，不能读取该属性，只有当两者都有时才能正常读取和设置属性。</p>
<h2 id="三、对象属性的特性"><a href="#三、对象属性的特性" class="headerlink" title="三、对象属性的特性"></a>三、对象属性的特性</h2><p>每个对象的数据属性都有四个特性（也可以说是属性描述符），分别为：</p>
<ol>
<li><code>value</code>  属性的值</li>
<li><code>writable</code>  可写性，如果为<code>false</code>该值将不能被修改</li>
<li><code>enumerable</code>  可枚举性，如果为<code>false</code>将不能被枚举</li>
<li><code>configurable</code>  可配置性，如果为<code>false</code>将不能被配置，即不能被<code>delete</code>操作符删除，不能更改这四个特性，一旦设为<code>false</code>则无法再设为<code>true</code>，也就是一个不可逆过程</li>
</ol>
<p>前面我们讲过存储器属性，每隔对象的存储器属性同样也有四个特性，分别为：</p>
<ol>
<li><code>get</code></li>
<li><code>set</code></li>
<li><code>enumerable</code></li>
<li><code>configurable</code></li>
</ol>
<p>如果想要获得一个对象某个属性的这四个特性，可以调用 Object.getOwnPropertyDescriptor() 方法，该方法接受两个参数，第一个为对象，第二个为对象的属性</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> obj = &#123;</span><br><span class="line">    name: <span class="string">&#x27;jack&#x27;</span>,</span><br><span class="line">    age: <span class="number">12</span>,</span><br><span class="line">    get age1 () &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">this</span>.age1</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="keyword">set</span> <span class="title">age1</span>(<span class="params">value</span>) &#123;</span><br><span class="line">        <span class="built_in">this</span>.age1 = value</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 获取数值属性的特性</span></span><br><span class="line"><span class="built_in">Object</span>.getOwnPropertyDescriptor(obj,<span class="string">&#x27;name&#x27;</span>)</span><br><span class="line"><span class="comment">// &#123;value: &quot;jack&quot;, writable: true, enumerable: true, configurable: true&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 获取存储器属性的特性</span></span><br><span class="line"><span class="built_in">Object</span>.getOwnPropertyDescriptor(obj,<span class="string">&#x27;age1&#x27;</span>)</span><br><span class="line"><span class="comment">// &#123;enumerable: true, configurable: true, get: ƒ, set: ƒ&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 试图获取不存在的属性，返回undefined</span></span><br><span class="line"><span class="built_in">Object</span>.getOwnPropertyDescriptor(obj, <span class="string">&#x27;sex&#x27;</span>)  <span class="comment">// undefined</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 试图获取原型上的属性，返回undefined </span></span><br><span class="line"><span class="built_in">Object</span>.getOwnPropertyDescriptor(obj, <span class="string">&#x27;toString&#x27;</span>)  <span class="comment">// undefined</span></span><br></pre></td></tr></table></figure>
<p>从上面可以看出，<code>Object.getOwnPropertyDescriptor()</code> 只能得到自有属性的描述符，要想获得继承属性的特性，我们可以把该对象的原型传进去。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Person</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">this</span>.name = <span class="string">&#x27;sillywa&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line">Person.prototype.sex = <span class="string">&#x27;boy&#x27;</span></span><br><span class="line">Person.prototype.age = <span class="number">13</span></span><br><span class="line"><span class="keyword">var</span> person1 = <span class="keyword">new</span> Person()</span><br><span class="line"><span class="built_in">Object</span>.getOwnPropertyDescriptor(person1.__proto__, <span class="string">&#x27;sex&#x27;</span>)</span><br><span class="line"><span class="comment">// &#123;value: &quot;boy&quot;, writable: true, enumerable: true, configurable: true&#125;</span></span><br></pre></td></tr></table></figure>
<p>以上可以看出，我们通过对象字面量和<code>new</code>运算符创建的对象的属性它们的<code>writable</code>,<code>enumerable</code>,<code>configurable</code>都有<code>true</code>，默认都是可写、可枚举、可配置。如果要修改属性的特性可以调用<code>Object.defineProperty()</code>。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> obj = &#123;</span><br><span class="line">    name: <span class="string">&#x27;sillywa&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 将name属性设为不可枚举并将其值设为jack</span></span><br><span class="line"><span class="built_in">Object</span>.defineProperty(obj, <span class="string">&#x27;name&#x27;</span>, &#123;</span><br><span class="line">    value: <span class="string">&#x27;jack&#x27;</span>,</span><br><span class="line">    enumerable: <span class="literal">false</span></span><br><span class="line">&#125;)</span><br><span class="line"><span class="built_in">Object</span>.getOwnPropertyDescriptor(obj, <span class="string">&#x27;name&#x27;</span>)</span><br><span class="line"><span class="comment">// &#123;value: &quot;jack&quot;, writable: true, enumerable: false, configurable: true&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 新增age属性</span></span><br><span class="line"><span class="built_in">Object</span>.defineProperty(obj, <span class="string">&#x27;age&#x27;</span>, &#123;</span><br><span class="line">    value: <span class="number">12</span></span><br><span class="line">&#125;)</span><br><span class="line"><span class="built_in">Object</span>.getOwnPropertyDescriptor(obj, <span class="string">&#x27;age&#x27;</span>)</span><br><span class="line"><span class="comment">// &#123;value: 12, writable: false, enumerable: false, configurable: false&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 将name变为存储器属性</span></span><br><span class="line"><span class="built_in">Object</span>.defineProperty(obj, <span class="string">&#x27;name&#x27;</span>, &#123;</span><br><span class="line">    get: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br><span class="line"><span class="built_in">Object</span>.getOwnPropertyDescriptor(obj, <span class="string">&#x27;name&#x27;</span>)</span><br><span class="line"><span class="comment">// &#123;set: undefined, enumerable: false, configurable: true, get: ƒ&#125;</span></span><br><span class="line"></span><br><span class="line">obj.age = <span class="number">78</span></span><br><span class="line">obj.age  <span class="comment">// 12</span></span><br></pre></td></tr></table></figure>
<p>需要注意的是通过<code>Object.defineProperty()</code> 创建的属性其<code>writable</code>, <code>enumerable</code>, <code>configurable</code> 都为<code>false</code>。尝试修改不写的属性不会报错，但也不会修改，只有在严格模式下才会报错。</p>
<p>如果需要同时修改和创建多个属性，可以使用<code>Object.defineProperties()</code>。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> obj = <span class="built_in">Object</span>.defineProperties(&#123;&#125;,&#123;</span><br><span class="line">    name: &#123;</span><br><span class="line">        value: <span class="string">&#x27;sillywa&#x27;</span>,</span><br><span class="line">        writable: <span class="literal">true</span>,</span><br><span class="line">        enumerable: <span class="literal">true</span>,</span><br><span class="line">        configurable: <span class="literal">true</span></span><br><span class="line">    &#125;,</span><br><span class="line">    age: &#123;</span><br><span class="line">        get: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&#x27;hello&#x27;</span> + <span class="built_in">this</span>.name</span><br><span class="line">        &#125;,</span><br><span class="line">        set: <span class="function"><span class="keyword">function</span> (<span class="params">value</span>) </span>&#123;</span><br><span class="line">            <span class="built_in">this</span>.name = <span class="string">&#x27;jack&#x27;</span></span><br><span class="line">        &#125;,</span><br><span class="line">        enumerable: <span class="literal">true</span>,</span><br><span class="line">        configurable: <span class="literal">true</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<h2 id="四、属性的设置和屏蔽"><a href="#四、属性的设置和屏蔽" class="headerlink" title="四、属性的设置和屏蔽"></a>四、属性的设置和屏蔽</h2><p>我们知道当我们书写以下代码时</p>
<p><code>obj.foo = &#39;bar&#39;</code></p>
<p>如果<code>obj</code>存在一个名为<code>foo</code>的普通数据访问属性，这条赋值语句只会修改已有的属性值。</p>
<p>如果<code>foo</code>不是直接存在于obj中，<code>[[prototype]]</code>链就会被遍历，如果原型链上找不到<code>foo</code>，<code>foo</code>就直接被添加到<code>obj</code>上。</p>
<p>然而，如果原型链上找到了<code>foo</code>属性，情况就有些不一样了。</p>
<p>如果属性<code>foo</code>既出现在<code>obj</code>中也在其原型链中，那么<code>obj</code>中包含的<code>foo</code>属性就会屏蔽原型链里面的<code>foo</code>属性，这就是属性屏蔽，原理就是属性的查找规则。</p>
<p>下面我们看一下如果<code>foo</code>不直接存在于<code>obj</code>中，而是在其原型链中时，<code>obj.foo = &#39;bar&#39;</code>会出现的三种情况：</p>
<ol>
<li>如果原型链中存在名为<code>foo</code>的普通数据访问属性并且其<code>writable</code>为<code>true</code>，那么就会直接在<code>obj</code>中添加<code>foo</code>属性，它是属性屏蔽。</li>
<li>如果原型链中存在<code>foo</code>，但其<code>writabla</code>为<code>false</code>，那么无法修改已有属性或者在<code>obj</code>中创建屏蔽属性。如果运行在严格模式下，会抛出一个错误。否则这条赋值语句会被忽略，不会发生属性屏蔽。</li>
<li>如果原型链上存在<code>foo</code>并且它是一个<code>setter</code>，那就一定会调用这个<code>setter</code>。<code>foo</code>不会被添加到<code>obj</code>中，也不会重新定义这个<code>setter</code>。</li>
</ol>
<p>大多数人认为，如果向原型链中已存在的属性赋值，就一定会发生属性屏蔽，但以上三种情况只有一种是如此。</p>
<p>如果希望在任何情况下都屏蔽<code>foo</code>，那就不能使用<code>=</code>操作符来赋值，而是使用<code>Object.defineProperty()</code>来向<code>obj</code>中添加<code>foo</code>。</p>
<p>情况一：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Person</span>(<span class="params"></span>) </span>&#123; &#125;</span><br><span class="line">Person.prototype.foo = <span class="string">&#x27;foo&#x27;</span></span><br><span class="line"><span class="keyword">var</span> obj = <span class="keyword">new</span> Person()</span><br><span class="line">obj.foo = <span class="string">&#x27;bar&#x27;</span></span><br><span class="line">obj.foo   <span class="comment">// &#x27;bar&#x27;</span></span><br></pre></td></tr></table></figure>
<p>情况二：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Person</span>(<span class="params"></span>) </span>&#123;&#125;</span><br><span class="line"><span class="built_in">Object</span>.defineProperty(Person.prototype,<span class="string">&#x27;foo&#x27;</span>,&#123;</span><br><span class="line">    writable: <span class="literal">false</span>,</span><br><span class="line">    enumerable: <span class="literal">true</span>,</span><br><span class="line">    configurable: <span class="literal">true</span>,</span><br><span class="line">    value: <span class="string">&#x27;foo&#x27;</span></span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">var</span> obj = <span class="keyword">new</span> Person()</span><br><span class="line">obj.foo = <span class="string">&#x27;bar&#x27;</span></span><br><span class="line">obj.foo  <span class="comment">// &#x27;foo&#x27;</span></span><br></pre></td></tr></table></figure>
<p>情况三：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Person</span>(<span class="params"></span>) </span>&#123;&#125;</span><br><span class="line">Person.prototype = &#123;</span><br><span class="line">    <span class="keyword">constructor</span>: Person,</span><br><span class="line">    name: &#x27;foo&#x27;,</span><br><span class="line">    set foo (value) &#123;</span><br><span class="line">        <span class="built_in">this</span>.name = value</span><br><span class="line">    &#125;,</span><br><span class="line">    get foo () &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">this</span>.name</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> obj = <span class="keyword">new</span> Person()</span><br><span class="line">obj.foo = <span class="string">&#x27;bar&#x27;</span></span><br><span class="line">obj.foo  <span class="comment">// &#x27;bar&#x27;</span></span><br><span class="line"><span class="comment">// obj中并没有foo这个属性，只是调用了setter</span></span><br><span class="line">obj.hasOwnProperty(<span class="string">&#x27;foo&#x27;</span>) <span class="comment">// false</span></span><br></pre></td></tr></table></figure>
<p>有些情况下会隐式产生屏蔽，一定要注意，思考一下代码：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> obj = &#123;</span><br><span class="line">    a: <span class="number">2</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> myObj = <span class="built_in">Object</span>.create(obj)</span><br><span class="line">obj.a  <span class="comment">// 2</span></span><br><span class="line">myObj.a  <span class="comment">// 2</span></span><br><span class="line"></span><br><span class="line">obj.hasOwnProperty(<span class="string">&#x27;a&#x27;</span>)  <span class="comment">// true</span></span><br><span class="line">myObj.hasOwnProperty(<span class="string">&#x27;a&#x27;</span>)  <span class="comment">// false</span></span><br><span class="line"></span><br><span class="line">myObj.a ++  <span class="comment">// 隐式屏蔽</span></span><br><span class="line"></span><br><span class="line">obj.a  <span class="comment">// 2</span></span><br><span class="line">myObj.a  <span class="comment">// 3</span></span><br><span class="line"></span><br><span class="line">myObj.hasOwnProperty(<span class="string">&#x27;a&#x27;</span>)  <span class="comment">// true</span></span><br></pre></td></tr></table></figure>
<p>尽管<code>myObj.a ++ </code>看起来是查找并增加<code>obj.a</code>的属性，但是别忘了<code>++</code>操作符相当于<code>myObj.a = myObj.a + 1</code>；因此<code>++</code>操作首先会通过原型链查找到<code>obj.a</code>，并读取其值为2，然后加1赋值给<code>myObj.a</code>。</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  


  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/3/"><i class="fa fa-angle-left" aria-label="上一页"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/3/">3</a><span class="page-number current">4</span><a class="page-number" href="/page/5/">5</a><a class="extend next" rel="next" href="/page/5/"><i class="fa fa-angle-right" aria-label="下一页"></i></a>
  </nav>



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Sillywa"
      src="/images/logo.png">
  <p class="site-author-name" itemprop="name">Sillywa</p>
  <div class="site-description" itemprop="description">个人学习记录博客</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">43</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">10</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">28</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/Sillywa" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;Sillywa" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
  </div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Sillywa</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://pisces.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Pisces</a> 强力驱动
  </div>
<div>
<span id="timeDate"></span><span id="times"></span>
</div>
<script>
    var now = new Date();
    function createtime() {
        var grt= new Date("12/03/2018 00:00:00");//此处修改你的建站时间或者网站上线时间
        now.setTime(now.getTime()+250);
        days = (now - grt ) / 1000 / 60 / 60 / 24; dnum = Math.floor(days);
        hours = (now - grt ) / 1000 / 60 / 60 - (24 * dnum); hnum = Math.floor(hours);
        if(String(hnum).length ==1 ){hnum = "0" + hnum;} minutes = (now - grt ) / 1000 /60 - (24 * 60 * dnum) - (60 * hnum);
        mnum = Math.floor(minutes); if(String(mnum).length ==1 ){mnum = "0" + mnum;}
        seconds = (now - grt ) / 1000 - (24 * 60 * 60 * dnum) - (60 * 60 * hnum) - (60 * mnum);
        snum = Math.round(seconds); if(String(snum).length ==1 ){snum = "0" + snum;}
        document.getElementById("timeDate").innerHTML = "Running for "+dnum+" Days ";
        document.getElementById("times").innerHTML = hnum + " Hours " + mnum + " m " + snum + " s";
    }
    setInterval("createtime()",250);
</script>

        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    <span class="post-meta-item" id="busuanzi_container_site_uv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="总访客量">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item" id="busuanzi_container_site_pv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="总访问量">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  




  
<script src="/js/local-search.js"></script>













  

  

</body>
</html>
